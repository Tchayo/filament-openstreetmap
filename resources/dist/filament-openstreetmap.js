var ao=Object.create;var Bn=Object.defineProperty;var lo=Object.getOwnPropertyDescriptor;var ho=Object.getOwnPropertyNames;var uo=Object.getPrototypeOf,co=Object.prototype.hasOwnProperty;var fo=(i,t)=>()=>(t||i((t={exports:{}}).exports,t),t.exports);var mo=(i,t,e,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of ho(t))!co.call(i,r)&&r!==e&&Bn(i,r,{get:()=>t[r],enumerable:!(n=lo(t,r))||n.enumerable});return i};var go=(i,t,e)=>(e=i!=null?ao(uo(i)):{},mo(t||!i||!i.__esModule?Bn(e,"default",{value:i,enumerable:!0}):e,i));var Ei=fo((Bs,yi)=>{"use strict";yi.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}});var Re=class{constructor(t){this.propagationStopped,this.defaultPrevented,this.type=t,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}};var O=Re;var B={PROPERTYCHANGE:"propertychange"};var we=class{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}},yt=we;function $n(i,t){return i>t?1:i<t?-1:0}function ee(i,t,e){if(i[0]<=t)return 0;let n=i.length;if(t<=i[n-1])return n-1;if(typeof e=="function"){for(let r=1;r<n;++r){let o=i[r];if(o===t)return r;if(o<t)return e(t,i[r-1],o)>0?r-1:r}return n-1}if(e>0){for(let r=1;r<n;++r)if(i[r]<t)return r-1;return n-1}if(e<0){for(let r=1;r<n;++r)if(i[r]<=t)return r;return n-1}for(let r=1;r<n;++r){if(i[r]==t)return r;if(i[r]<t)return i[r-1]-t<t-i[r]?r-1:r}return n-1}function Qn(i,t){let e=Array.isArray(t)?t:[t],n=e.length;for(let r=0;r<n;r++)i[i.length]=e[r]}function Et(i,t){let e=i.length;if(e!==t.length)return!1;for(let n=0;n<e;n++)if(i[n]!==t[n])return!1;return!0}function ht(){return!0}function $(){return!1}function ut(){}function Jn(i){let t=!1,e,n,r;return function(){let o=Array.prototype.slice.call(arguments);return(!t||this!==r||!Et(o,n))&&(t=!0,r=this,n=o,e=i.apply(this,arguments)),e}}function Z(i){for(let t in i)delete i[t]}function ti(i){let t;for(t in i)return!1;return!t}var Ie=class extends yt{constructor(t){super(),this.eventTarget_=t,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(t,e){if(!t||!e)return;let n=this.listeners_||(this.listeners_={}),r=n[t]||(n[t]=[]);r.includes(e)||r.push(e)}dispatchEvent(t){let e=typeof t=="string",n=e?t:t.type,r=this.listeners_&&this.listeners_[n];if(!r)return;let o=e?new O(t):t;o.target||(o.target=this.eventTarget_||this);let s=this.dispatching_||(this.dispatching_={}),a=this.pendingRemovals_||(this.pendingRemovals_={});n in s||(s[n]=0,a[n]=0),++s[n];let l;for(let h=0,u=r.length;h<u;++h)if("handleEvent"in r[h]?l=r[h].handleEvent(o):l=r[h].call(this,o),l===!1||o.propagationStopped){l=!1;break}if(--s[n]===0){let h=a[n];for(delete a[n];h--;)this.removeEventListener(n,ut);delete s[n]}return l}disposeInternal(){this.listeners_&&Z(this.listeners_)}getListeners(t){return this.listeners_&&this.listeners_[t]||void 0}hasListener(t){return this.listeners_?t?t in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(t,e){if(!this.listeners_)return;let n=this.listeners_[t];if(!n)return;let r=n.indexOf(e);r!==-1&&(this.pendingRemovals_&&t in this.pendingRemovals_?(n[r]=ut,++this.pendingRemovals_[t]):(n.splice(r,1),n.length===0&&delete this.listeners_[t]))}},ne=Ie;var _={CHANGE:"change",ERROR:"error",BLUR:"blur",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",FOCUS:"focus",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",RESIZE:"resize",TOUCHMOVE:"touchmove",WHEEL:"wheel"};function E(i,t,e,n,r){if(n&&n!==i&&(e=e.bind(n)),r){let s=e;e=function(){i.removeEventListener(t,e),s.apply(this,arguments)}}let o={target:i,type:t,listener:e};return i.addEventListener(t,e),o}function Te(i,t,e,n){return E(i,t,e,n,!0)}function w(i){i&&i.target&&(i.target.removeEventListener(i.type,i.listener),Z(i))}var xt=class extends ne{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(_.CHANGE)}getRevision(){return this.revision_}onInternal(t,e){if(Array.isArray(t)){let n=t.length,r=new Array(n);for(let o=0;o<n;++o)r[o]=E(this,t[o],e);return r}return E(this,t,e)}onceInternal(t,e){let n;if(Array.isArray(t)){let r=t.length;n=new Array(r);for(let o=0;o<r;++o)n[o]=Te(this,t[o],e)}else n=Te(this,t,e);return e.ol_key=n,n}unInternal(t,e){let n=e.ol_key;if(n)po(n);else if(Array.isArray(t))for(let r=0,o=t.length;r<o;++r)this.removeEventListener(t[r],e);else this.removeEventListener(t,e)}};xt.prototype.on;xt.prototype.once;xt.prototype.un;function po(i){if(Array.isArray(i))for(let t=0,e=i.length;t<e;++t)w(i[t]);else w(i)}var ei=xt;function T(){throw new Error("Unimplemented abstract method.")}var _o=0;function ct(i){return i.ol_uid||(i.ol_uid=String(++_o))}var ie=class extends O{constructor(t,e,n){super(t),this.key=e,this.oldValue=n}},Ae=class extends ei{constructor(t){super(),this.on,this.once,this.un,ct(this),this.values_=null,t!==void 0&&this.setProperties(t)}get(t){let e;return this.values_&&this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(t,e){let n;n=`change:${t}`,this.hasListener(n)&&this.dispatchEvent(new ie(n,t,e)),n=B.PROPERTYCHANGE,this.hasListener(n)&&this.dispatchEvent(new ie(n,t,e))}addChangeListener(t,e){this.addEventListener(`change:${t}`,e)}removeChangeListener(t,e){this.removeEventListener(`change:${t}`,e)}set(t,e,n){let r=this.values_||(this.values_={});if(n)r[t]=e;else{let o=r[t];r[t]=e,o!==e&&this.notify(t,o)}}setProperties(t,e){for(let n in t)this.set(n,t[n],e)}applyProperties(t){t.values_&&Object.assign(this.values_||(this.values_={}),t.values_)}unset(t,e){if(this.values_&&t in this.values_){let n=this.values_[t];delete this.values_[t],ti(this.values_)&&(this.values_=null),e||this.notify(t,n)}}},M=Ae;var b={ADD:"add",REMOVE:"remove"};var ni={LENGTH:"length"},vt=class extends O{constructor(t,e,n){super(t),this.element=e,this.index=n}},Le=class extends M{constructor(t,e){if(super(),this.on,this.once,this.un,e=e||{},this.unique_=!!e.unique,this.array_=t||[],this.unique_)for(let n=0,r=this.array_.length;n<r;++n)this.assertUnique_(this.array_[n],n);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(t){for(let e=0,n=t.length;e<n;++e)this.push(t[e]);return this}forEach(t){let e=this.array_;for(let n=0,r=e.length;n<r;++n)t(e[n],n,e)}getArray(){return this.array_}item(t){return this.array_[t]}getLength(){return this.get(ni.LENGTH)}insertAt(t,e){if(t<0||t>this.getLength())throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new vt(b.ADD,e,t))}pop(){return this.removeAt(this.getLength()-1)}push(t){this.unique_&&this.assertUnique_(t);let e=this.getLength();return this.insertAt(e,t),this.getLength()}remove(t){let e=this.array_;for(let n=0,r=e.length;n<r;++n)if(e[n]===t)return this.removeAt(n)}removeAt(t){if(t<0||t>=this.getLength())return;let e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new vt(b.REMOVE,e,t)),e}setAt(t,e){let n=this.getLength();if(t>=n){this.insertAt(t,e);return}if(t<0)throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e,t);let r=this.array_[t];this.array_[t]=e,this.dispatchEvent(new vt(b.REMOVE,r,t)),this.dispatchEvent(new vt(b.ADD,e,t))}updateLength_(){this.set(ni.LENGTH,this.array_.length)}assertUnique_(t,e){for(let n=0,r=this.array_.length;n<r;++n)if(this.array_[n]===t&&n!==e)throw new Error("Duplicate item added to a unique collection")}},D=Le;var nt=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",ii=nt.includes("firefox"),yo=nt.includes("safari")&&!nt.includes("chrom"),bs=yo&&(nt.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(nt)),ri=nt.includes("webkit")&&!nt.includes("edge"),Me=nt.includes("macintosh"),re=typeof devicePixelRatio<"u"?devicePixelRatio:1,oi=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,Os=typeof Image<"u"&&Image.prototype.decode;var oe=function(){let i=!1;try{let t=Object.defineProperty({},"passive",{get:function(){i=!0}});window.addEventListener("_",null,t),window.removeEventListener("_",null,t)}catch{}return i}();function I(i,t){if(!i)throw new Error(t)}var ks=new Array(6);function kt(){return[1,0,0,1,0,0]}function Se(i,t){let e=t[0],n=t[1];return t[0]=i[0]*e+i[2]*n+i[4],t[1]=i[1]*e+i[3]*n+i[5],t}function se(i,t,e,n,r,o,s,a){let l=Math.sin(o),h=Math.cos(o);return i[0]=n*h,i[1]=r*l,i[2]=-n*l,i[3]=r*h,i[4]=s*n*h-a*n*l+t,i[5]=s*r*l+a*r*h+e,i}function si(i,t){let e=Eo(t);I(e!==0,"Transformation matrix cannot be inverted");let n=t[0],r=t[1],o=t[2],s=t[3],a=t[4],l=t[5];return i[0]=s/e,i[1]=-r/e,i[2]=-o/e,i[3]=n/e,i[4]=(o*l-s*a)/e,i[5]=-(n*l-r*a)/e,i}function Eo(i){return i[0]*i[3]-i[1]*i[2]}var A={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function xo(i,t,e){let n=Math.min.apply(null,i),r=Math.min.apply(null,t),o=Math.max.apply(null,i),s=Math.max.apply(null,t);return le(n,r,o,s,e)}function li(i,t){return t?(t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t):i.slice()}function ae(i,t,e){let n,r;return t<i[0]?n=i[0]-t:i[2]<t?n=t-i[2]:n=0,e<i[1]?r=i[1]-e:i[3]<e?r=e-i[3]:r=0,n*n+r*r}function hi(i,t){return i[0]<=t[0]&&t[2]<=i[2]&&i[1]<=t[1]&&t[3]<=i[3]}function ui(i,t,e){return i[0]<=t&&t<=i[2]&&i[1]<=e&&e<=i[3]}function ai(i,t){let e=i[0],n=i[1],r=i[2],o=i[3],s=t[0],a=t[1],l=A.UNKNOWN;return s<e?l=l|A.LEFT:s>r&&(l=l|A.RIGHT),a<n?l=l|A.BELOW:a>o&&(l=l|A.ABOVE),l===A.UNKNOWN&&(l=A.INTERSECTING),l}function Kt(){return[1/0,1/0,-1/0,-1/0]}function le(i,t,e,n,r){return r?(r[0]=i,r[1]=t,r[2]=e,r[3]=n,r):[i,t,e,n]}function dt(i){return le(1/0,1/0,-1/0,-1/0,i)}function ci(i,t){let e=i[0],n=i[1];return le(e,n,e,n,t)}function di(i,t,e,n,r){let o=dt(r);return be(o,i,t,e,n)}function Pe(i,t){return i[0]==t[0]&&i[2]==t[2]&&i[1]==t[1]&&i[3]==t[3]}function be(i,t,e,n,r){for(;e<n;e+=r)vo(i,t[e],t[e+1]);return i}function vo(i,t,e){i[0]=Math.min(i[0],t),i[1]=Math.min(i[1],e),i[2]=Math.max(i[2],t),i[3]=Math.max(i[3],e)}function fi(i,t){let e;return e=t(Co(i)),e||(e=t(Ro(i)),e)||(e=t(To(i)),e)||(e=t(Io(i)),e)?e:!1}function Co(i){return[i[0],i[1]]}function Ro(i){return[i[2],i[1]]}function ft(i){return[(i[0]+i[2])/2,(i[1]+i[3])/2]}function zt(i,t,e,n,r){let[o,s,a,l,h,u,c,d]=wo(i,t,e,n);return le(Math.min(o,a,h,c),Math.min(s,l,u,d),Math.max(o,a,h,c),Math.max(s,l,u,d),r)}function wo(i,t,e,n){let r=t*n[0]/2,o=t*n[1]/2,s=Math.cos(e),a=Math.sin(e),l=r*s,h=r*a,u=o*s,c=o*a,d=i[0],f=i[1];return[d-l+c,f-h-u,d-l-c,f-h+u,d+l-c,f+h+u,d+l+c,f+h-u,d-l+c,f-h-u]}function it(i){return i[3]-i[1]}function mi(i,t,e){let n=e||Kt();return Gt(i,t)?(i[0]>t[0]?n[0]=i[0]:n[0]=t[0],i[1]>t[1]?n[1]=i[1]:n[1]=t[1],i[2]<t[2]?n[2]=i[2]:n[2]=t[2],i[3]<t[3]?n[3]=i[3]:n[3]=t[3]):dt(n),n}function Io(i){return[i[0],i[3]]}function To(i){return[i[2],i[3]]}function z(i){return i[2]-i[0]}function Gt(i,t){return i[0]<=t[2]&&i[2]>=t[0]&&i[1]<=t[3]&&i[3]>=t[1]}function mt(i){return i[2]<i[0]||i[3]<i[1]}function gi(i,t){return t?(t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t):i}function pi(i,t,e){let n=!1,r=ai(i,t),o=ai(i,e);if(r===A.INTERSECTING||o===A.INTERSECTING)n=!0;else{let s=i[0],a=i[1],l=i[2],h=i[3],u=t[0],c=t[1],d=e[0],f=e[1],m=(f-c)/(d-u),g,p;o&A.ABOVE&&!(r&A.ABOVE)&&(g=d-(f-h)/m,n=g>=s&&g<=l),!n&&o&A.RIGHT&&!(r&A.RIGHT)&&(p=f-(d-l)*m,n=p>=a&&p<=h),!n&&o&A.BELOW&&!(r&A.BELOW)&&(g=d-(f-a)/m,n=g>=s&&g<=l),!n&&o&A.LEFT&&!(r&A.LEFT)&&(p=f-(d-s)*m,n=p>=a&&p<=h)}return n}function _i(i,t,e,n){if(mt(i))return dt(e);let r=[];if(n>1){let a=i[2]-i[0],l=i[3]-i[1];for(let h=0;h<n;++h)r.push(i[0]+a*h/n,i[1],i[2],i[1]+l*h/n,i[2]-a*h/n,i[3],i[0],i[3]-l*h/n)}else r=[i[0],i[1],i[2],i[1],i[2],i[3],i[0],i[3]];t(r,r,2);let o=[],s=[];for(let a=0,l=r.length;a<l;a+=2)o.push(r[a]),s.push(r[a+1]);return xo(o,s,e)}var Ct={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]};var gt={name:"xyz",min:[0,0,0],channel:["X","Y","Z"],alias:["XYZ","ciexyz","cie1931"]};gt.whitepoint={2:{A:[109.85,100,35.585],C:[98.074,100,118.232],D50:[96.422,100,82.521],D55:[95.682,100,92.149],D65:[95.045592705167,100,108.9057750759878],D75:[94.972,100,122.638],F2:[99.187,100,67.395],F7:[95.044,100,108.755],F11:[100.966,100,64.37],E:[100,100,100]},10:{A:[111.144,100,35.2],C:[97.285,100,116.145],D50:[96.72,100,81.427],D55:[95.799,100,90.926],D65:[94.811,100,107.304],D75:[94.416,100,120.641],F2:[103.28,100,69.026],F7:[95.792,100,107.687],F11:[103.866,100,65.627],E:[100,100,100]}};gt.max=gt.whitepoint[2].D65;gt.rgb=function(i,t){t=t||gt.whitepoint[2].E;var e=i[0]/t[0],n=i[1]/t[1],r=i[2]/t[2],o,s,a;return o=e*3.240969941904521+n*-1.537383177570093+r*-.498610760293,s=e*-.96924363628087+n*1.87596750150772+r*.041555057407175,a=e*.055630079696993+n*-.20397695888897+r*1.056971514242878,o=o>.0031308?1.055*Math.pow(o,1/2.4)-.055:o=o*12.92,s=s>.0031308?1.055*Math.pow(s,1/2.4)-.055:s=s*12.92,a=a>.0031308?1.055*Math.pow(a,1/2.4)-.055:a=a*12.92,o=Math.min(Math.max(0,o),1),s=Math.min(Math.max(0,s),1),a=Math.min(Math.max(0,a),1),[o*255,s*255,a*255]};Ct.xyz=function(i,t){var e=i[0]/255,n=i[1]/255,r=i[2]/255;e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92,n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92,r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92;var o=e*.41239079926595+n*.35758433938387+r*.18048078840183,s=e*.21263900587151+n*.71516867876775+r*.072192315360733,a=e*.019330818715591+n*.11919477979462+r*.95053215224966;return t=t||gt.whitepoint[2].E,[o*t[0],s*t[1],a*t[2]]};var F=gt;var Oe={name:"luv",min:[0,-134,-140],max:[100,224,122],channel:["lightness","u","v"],alias:["LUV","cieluv","cie1976"],xyz:function(i,t,e){var n,r,o,s,a,l,h,u,c,d,f,m,g;if(o=i[0],s=i[1],a=i[2],o===0)return[0,0,0];var p=.0011070564598794539;return t=t||"D65",e=e||2,c=F.whitepoint[e][t][0],d=F.whitepoint[e][t][1],f=F.whitepoint[e][t][2],m=4*c/(c+15*d+3*f),g=9*d/(c+15*d+3*f),n=s/(13*o)+m||0,r=a/(13*o)+g||0,h=o>8?d*Math.pow((o+16)/116,3):d*o*p,l=h*9*n/(4*r)||0,u=h*(12-3*n-20*r)/(4*r)||0,[l,h,u]}};F.luv=function(i,t,e){var n,r,o,s,a,l,h,u,c,d,f,m,g,p=.008856451679035631,v=903.2962962962961;t=t||"D65",e=e||2,c=F.whitepoint[e][t][0],d=F.whitepoint[e][t][1],f=F.whitepoint[e][t][2],m=4*c/(c+15*d+3*f),g=9*d/(c+15*d+3*f),l=i[0],h=i[1],u=i[2],n=4*l/(l+15*h+3*u)||0,r=9*h/(l+15*h+3*u)||0;var y=h/d;return o=y<=p?v*y:116*Math.pow(y,1/3)-16,s=13*o*(n-m),a=13*o*(r-g),[o,s,a]};Oe.lchuv=function(i){var t=i[0],e=i[1],n=i[2],r=Math.sqrt(e*e+n*n),o=Math.atan2(n,e),s=o*360/2/Math.PI;return s<0&&(s+=360),[t,r,s]};F.lchuv=function(i){return Oe.lchuv(F.luv(i))};var Ao=go(Ei(),1);Ct.hsl=function(i){var t=i[0]/255,e=i[1]/255,n=i[2]/255,r=Math.min(t,e,n),o=Math.max(t,e,n),s=o-r,a,l,h;return o===r?a=0:t===o?a=(e-n)/s:e===o?a=2+(n-t)/s:n===o&&(a=4+(t-e)/s),a=Math.min(a*60,360),a<0&&(a+=360),h=(r+o)/2,o===r?l=0:h<=.5?l=s/(o+r):l=s/(2-o-r),[a,l*100,h*100]};function S(i,t,e){return Math.min(Math.max(i,t),e)}function xi(i,t,e,n,r,o){let s=r-e,a=o-n;if(s!==0||a!==0){let l=((i-e)*s+(t-n)*a)/(s*s+a*a);l>1?(e=r,n=o):l>0&&(e+=s*l,n+=a*l)}return Q(i,t,e,n)}function Q(i,t,e,n){let r=e-i,o=n-t;return r*r+o*o}function vi(i){return i*Math.PI/180}function Ne(i,t){let e=i%t;return e*t<0?e+t:e}function Ci(i,t,e){return i+e*(t-i)}function Ri(i){return typeof i=="string"?i:Lo(i)}function Lo(i){let t=i[0];t!=(t|0)&&(t=t+.5|0);let e=i[1];e!=(e|0)&&(e=e+.5|0);let n=i[2];n!=(n|0)&&(n=n+.5|0);let r=i[3]===void 0?1:Math.round(i[3]*100)/100;return"rgba("+t+","+e+","+n+","+r+")"}var De=class{constructor(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}clear(){this.cache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let t=0;for(let e in this.cache_){let n=this.cache_[e];!(t++&3)&&!n.hasListener()&&(delete this.cache_[e],--this.cacheSize_)}}}get(t,e,n){let r=wi(t,e,n);return r in this.cache_?this.cache_[r]:null}set(t,e,n,r){let o=wi(t,e,n);this.cache_[o]=r,++this.cacheSize_}setSize(t){this.maxCacheSize_=t,this.expire()}};function wi(i,t,e){let n=e?Ri(e):"null";return t+":"+i+":"+n}var Fe=new De;var x={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};var ke=class extends M{constructor(t){super(),this.on,this.once,this.un,this.background_=t.background;let e=Object.assign({},t);typeof t.properties=="object"&&(delete e.properties,Object.assign(e,t.properties)),e[x.OPACITY]=t.opacity!==void 0?t.opacity:1,I(typeof e[x.OPACITY]=="number","Layer opacity must be a number"),e[x.VISIBLE]=t.visible!==void 0?t.visible:!0,e[x.Z_INDEX]=t.zIndex,e[x.MAX_RESOLUTION]=t.maxResolution!==void 0?t.maxResolution:1/0,e[x.MIN_RESOLUTION]=t.minResolution!==void 0?t.minResolution:0,e[x.MIN_ZOOM]=t.minZoom!==void 0?t.minZoom:-1/0,e[x.MAX_ZOOM]=t.maxZoom!==void 0?t.maxZoom:1/0,this.className_=e.className!==void 0?e.className:"ol-layer",delete e.className,this.setProperties(e),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(t){let e=this.state_||{layer:this,managed:t===void 0?!0:t},n=this.getZIndex();return e.opacity=S(Math.round(this.getOpacity()*100)/100,0,1),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=n===void 0&&!e.managed?1/0:n,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e}getLayersArray(t){return T()}getLayerStatesArray(t){return T()}getExtent(){return this.get(x.EXTENT)}getMaxResolution(){return this.get(x.MAX_RESOLUTION)}getMinResolution(){return this.get(x.MIN_RESOLUTION)}getMinZoom(){return this.get(x.MIN_ZOOM)}getMaxZoom(){return this.get(x.MAX_ZOOM)}getOpacity(){return this.get(x.OPACITY)}getSourceState(){return T()}getVisible(){return this.get(x.VISIBLE)}getZIndex(){return this.get(x.Z_INDEX)}setBackground(t){this.background_=t,this.changed()}setExtent(t){this.set(x.EXTENT,t)}setMaxResolution(t){this.set(x.MAX_RESOLUTION,t)}setMinResolution(t){this.set(x.MIN_RESOLUTION,t)}setMaxZoom(t){this.set(x.MAX_ZOOM,t)}setMinZoom(t){this.set(x.MIN_ZOOM,t)}setOpacity(t){I(typeof t=="number","Layer opacity must be a number"),this.set(x.OPACITY,t)}setVisible(t){this.set(x.VISIBLE,t)}setZIndex(t){this.set(x.Z_INDEX,t)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}},he=ke;var J={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"};var N={ANIMATING:0,INTERACTING:1};var k={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};var Vt={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};var Ke=class{constructor(t){this.code_=t.code,this.units_=t.units,this.extent_=t.extent!==void 0?t.extent:null,this.worldExtent_=t.worldExtent!==void 0?t.worldExtent:null,this.axisOrientation_=t.axisOrientation!==void 0?t.axisOrientation:"enu",this.global_=t.global!==void 0?t.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||Vt[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(t){this.global_=t,this.canWrapX_=!!(t&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(t){this.defaultTileGrid_=t}setExtent(t){this.extent_=t,this.canWrapX_=!!(this.global_&&t)}setWorldExtent(t){this.worldExtent_=t}setGetPointResolution(t){this.getPointResolutionFunc_=t}getPointResolutionFunc(){return this.getPointResolutionFunc_}},ue=Ke;var Ut=6378137,Rt=Math.PI*Ut,Mo=[-Rt,-Rt,Rt,Rt],So=[-180,-85,180,85],ce=Ut*Math.log(Math.tan(Math.PI/2)),rt=class extends ue{constructor(t){super({code:t,units:"m",extent:Mo,global:!0,worldExtent:So,getPointResolution:function(e,n){return e/Math.cosh(n[1]/Ut)}})}},ze=[new rt("EPSG:3857"),new rt("EPSG:102100"),new rt("EPSG:102113"),new rt("EPSG:900913"),new rt("http://www.opengis.net/def/crs/EPSG/0/3857"),new rt("http://www.opengis.net/gml/srs/epsg.xml#3857")];function Ii(i,t,e){let n=i.length;e=e>1?e:2,t===void 0&&(e>2?t=i.slice():t=new Array(n));for(let r=0;r<n;r+=e){t[r]=Rt*i[r]/180;let o=Ut*Math.log(Math.tan(Math.PI*(+i[r+1]+90)/360));o>ce?o=ce:o<-ce&&(o=-ce),t[r+1]=o}return t}function Ti(i,t,e){let n=i.length;e=e>1?e:2,t===void 0&&(e>2?t=i.slice():t=new Array(n));for(let r=0;r<n;r+=e)t[r]=180*i[r]/Rt,t[r+1]=360*Math.atan(Math.exp(i[r+1]/Ut))/Math.PI-90;return t}var Po=6378137,Ai=[-180,-90,180,90],bo=Math.PI*Po/180,tt=class extends ue{constructor(t,e){super({code:t,units:"degrees",extent:Ai,axisOrientation:e,global:!0,metersPerUnit:bo,worldExtent:Ai})}},Ge=[new tt("CRS:84"),new tt("EPSG:4326","neu"),new tt("urn:ogc:def:crs:OGC:1.3:CRS84"),new tt("urn:ogc:def:crs:OGC:2:84"),new tt("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new tt("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new tt("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];var Ve={};function Li(i){return Ve[i]||Ve[i.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function Mi(i,t){Ve[i]=t}var wt={};function Zt(i,t,e){let n=i.getCode(),r=t.getCode();n in wt||(wt[n]={}),wt[n][r]=e}function Si(i,t){let e;return i in wt&&t in wt[i]&&(e=wt[i][t]),e}function Pi(i,t){return i[0]+=+t[0],i[1]+=+t[1],i}function pt(i,t){let e=!0;for(let n=i.length-1;n>=0;--n)if(i[n]!=t[n]){e=!1;break}return e}function It(i,t){let e=Math.cos(t),n=Math.sin(t),r=i[0]*e-i[1]*n,o=i[1]*e+i[0]*n;return i[0]=r,i[1]=o,i}function bi(i,t){return i[0]*=t,i[1]*=t,i}function Oi(i,t){if(t.canWrapX()){let e=z(t.getExtent()),n=Ni(i,t,e);n&&(i[0]-=n*e)}return i}function Ni(i,t,e){let n=t.getExtent(),r=0;return t.canWrapX()&&(i[0]<n[0]||i[0]>n[2])&&(e=e||z(n),r=Math.floor((i[0]-n[0])/e)),r}var Di={info:1,warn:2,error:3,none:4},Oo=Di.info;function de(...i){Oo>Di.warn||console.warn(...i)}var Ue=!0;function ki(i){Ue=!(i===void 0?!0:i)}function Ki(i,t){if(t!==void 0){for(let e=0,n=i.length;e<n;++e)t[e]=i[e];t=t}else t=i.slice();return t}function No(i,t){if(t!==void 0&&i!==t){for(let e=0,n=i.length;e<n;++e)t[e]=i[e];i=t}return i}function Do(i){Mi(i.getCode(),i),Zt(i,i,Ki)}function Fo(i){i.forEach(Do)}function Tt(i){return typeof i=="string"?Li(i):i||null}function Fi(i){Fo(i),i.forEach(function(t){i.forEach(function(e){t!==e&&Zt(t,e,Ki)})})}function ko(i,t,e,n){i.forEach(function(r){t.forEach(function(o){Zt(r,o,e),Zt(o,r,n)})})}function fe(i,t){return i?typeof i=="string"?Tt(i):i:Tt(t)}function Ko(i,t){let e=i.getCode(),n=t.getCode(),r=Si(e,n);return r||(r=No),r}function Xt(i,t){let e=Tt(i),n=Tt(t);return Ko(e,n)}function zi(i,t,e){return Xt(t,e)(i,void 0,i.length)}function Gi(i,t,e,n){let r=Xt(t,e);return _i(i,r,void 0,n)}var et=null;function Vi(){return et}function Ht(i,t){return et?zi(i,t,et):i}function G(i,t){return et?zi(i,et,t):(Ue&&!pt(i,[0,0])&&i[0]>=-180&&i[0]<=180&&i[1]>=-90&&i[1]<=90&&(Ue=!1,de("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),i)}function Ui(i,t){return et?Gi(i,t,et):i}function Wt(i,t){return et?Gi(i,et,t):i}function zo(){Fi(ze),Fi(Ge),ko(Ge,ze,Ii,Ti)}zo();function Ze(i,t,e){return function(n,r,o,s,a){if(!n)return;if(!r&&!t)return n;let l=t?0:o[0]*r,h=t?0:o[1]*r,u=a?a[0]:0,c=a?a[1]:0,d=i[0]+l/2+u,f=i[2]-l/2+u,m=i[1]+h/2+c,g=i[3]-h/2+c;d>f&&(d=(f+d)/2,f=d),m>g&&(m=(g+m)/2,g=m);let p=S(n[0],d,f),v=S(n[1],m,g);if(s&&e&&r){let y=30*r;p+=-y*Math.log(1+Math.max(0,d-n[0])/y)+y*Math.log(1+Math.max(0,n[0]-f)/y),v+=-y*Math.log(1+Math.max(0,m-n[1])/y)+y*Math.log(1+Math.max(0,n[1]-g)/y)}return[p,v]}}function Zi(i){return i}function Xe(i,t,e,n){let r=z(t)/e[0],o=it(t)/e[1];return n?Math.min(i,Math.max(r,o)):Math.min(i,Math.min(r,o))}function He(i,t,e){let n=Math.min(i,t),r=50;return n*=Math.log(1+r*Math.max(0,i/t-1))/r+1,e&&(n=Math.max(n,e),n/=Math.log(1+r*Math.max(0,e/i-1))/r+1),S(n,e/2,t*2)}function Xi(i,t,e,n){return t=t!==void 0?t:!0,function(r,o,s,a){if(r!==void 0){let l=i[0],h=i[i.length-1],u=e?Xe(l,e,s,n):l;if(a)return t?He(r,u,h):S(r,h,u);let c=Math.min(u,r),d=Math.floor(ee(i,c,o));return i[d]>u&&d<i.length-1?i[d+1]:i[d]}}}function Hi(i,t,e,n,r,o){return n=n!==void 0?n:!0,e=e!==void 0?e:0,function(s,a,l,h){if(s!==void 0){let u=r?Xe(t,r,l,o):t;if(h)return n?He(s,u,e):S(s,e,u);let c=1e-9,d=Math.ceil(Math.log(t/u)/Math.log(i)-c),f=-a*(.5-c)+.5,m=Math.min(u,s),g=Math.floor(Math.log(t/m)/Math.log(i)+f),p=Math.max(d,g),v=t/Math.pow(i,p);return S(v,e,u)}}}function We(i,t,e,n,r){return e=e!==void 0?e:!0,function(o,s,a,l){if(o!==void 0){let h=n?Xe(i,n,a,r):i;return!e||!l?S(o,t,h):He(o,h,t)}}}function At(i){if(i!==void 0)return 0}function je(i){if(i!==void 0)return i}function Wi(i){let t=2*Math.PI/i;return function(e,n){if(n)return e;if(e!==void 0)return e=Math.floor(e/t+.5)*t,e}}function ji(i){let t=i===void 0?vi(5):i;return function(e,n){return n||e===void 0?e:Math.abs(e)<=t?0:e}}function Go(i){return Math.pow(i,3)}function K(i){return 1-Go(1-i)}function Yi(i){return 3*i*i-2*i*i*i}function qi(i){return i}function Ye(i,t,e,n,r,o){o=o||[];let s=0;for(let a=t;a<e;a+=n){let l=i[a],h=i[a+1];o[s++]=r[0]*l+r[2]*h+r[4],o[s++]=r[1]*l+r[3]*h+r[5]}return o&&o.length!=s&&(o.length=s),o}function Bi(i,t,e,n,r,o,s){s=s||[];let a=Math.cos(r),l=Math.sin(r),h=o[0],u=o[1],c=0;for(let d=t;d<e;d+=n){let f=i[d]-h,m=i[d+1]-u;s[c++]=h+f*a-m*l,s[c++]=u+f*l+m*a;for(let g=d+2;g<d+n;++g)s[c++]=i[g]}return s&&s.length!=c&&(s.length=c),s}function $i(i,t,e,n,r,o,s,a){a=a||[];let l=s[0],h=s[1],u=0;for(let c=t;c<e;c+=n){let d=i[c]-l,f=i[c+1]-h;a[u++]=l+r*d,a[u++]=h+o*f;for(let m=c+2;m<c+n;++m)a[u++]=i[m]}return a&&a.length!=u&&(a.length=u),a}function Qi(i,t,e,n,r,o,s){s=s||[];let a=0;for(let l=t;l<e;l+=n){s[a++]=i[l]+r,s[a++]=i[l+1]+o;for(let h=l+2;h<l+n;++h)s[a++]=i[h]}return s&&s.length!=a&&(s.length=a),s}var Ji=kt(),qe=class extends M{constructor(){super(),this.extent_=Kt(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=Jn((t,e,n)=>{if(!n)return this.getSimplifiedGeometry(e);let r=this.clone();return r.applyTransform(n),r.getSimplifiedGeometry(e)})}simplifyTransformed(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)}clone(){return T()}closestPointXY(t,e,n,r){return T()}containsXY(t,e){let n=this.getClosestPoint([t,e]);return n[0]===t&&n[1]===e}getClosestPoint(t,e){return e=e||[NaN,NaN],this.closestPointXY(t[0],t[1],e,1/0),e}intersectsCoordinate(t){return this.containsXY(t[0],t[1])}computeExtent(t){return T()}getExtent(t){if(this.extentRevision_!=this.getRevision()){let e=this.computeExtent(this.extent_);(isNaN(e[0])||isNaN(e[1]))&&dt(e),this.extentRevision_=this.getRevision()}return gi(this.extent_,t)}rotate(t,e){T()}scale(t,e,n){T()}simplify(t){return this.getSimplifiedGeometry(t*t)}getSimplifiedGeometry(t){return T()}getType(){return T()}applyTransform(t){T()}intersectsExtent(t){return T()}translate(t,e){T()}transform(t,e){let n=Tt(t),r=n.getUnits()=="tile-pixels"?function(o,s,a){let l=n.getExtent(),h=n.getWorldExtent(),u=it(h)/it(l);return se(Ji,h[0],h[3],u,-u,0,0,0),Ye(o,0,o.length,a,Ji,s),Xt(n,e)(o,s,a)}:Xt(n,e);return this.applyTransform(r),this}},tr=qe;var Be=class extends tr{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(t){return di(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinates(){return T()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;let e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getSimplifiedGeometryInternal(t){return this}getStride(){return this.stride}setFlatCoordinates(t,e){this.stride=er(t),this.layout=t,this.flatCoordinates=e}setCoordinates(t,e){T()}setLayout(t,e,n){let r;if(t)r=er(t);else{for(let o=0;o<n;++o){if(e.length===0){this.layout="XY",this.stride=2;return}e=e[0]}r=e.length,t=Vo(r)}this.layout=t,this.stride=r}applyTransform(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())}rotate(t,e){let n=this.getFlatCoordinates();if(n){let r=this.getStride();Bi(n,0,n.length,r,t,e,n),this.changed()}}scale(t,e,n){e===void 0&&(e=t),n||(n=ft(this.getExtent()));let r=this.getFlatCoordinates();if(r){let o=this.getStride();$i(r,0,r.length,o,t,e,n,r),this.changed()}}translate(t,e){let n=this.getFlatCoordinates();if(n){let r=this.getStride();Qi(n,0,n.length,r,t,e,n),this.changed()}}};function Vo(i){let t;return i==2?t="XY":i==3?t="XYZ":i==4&&(t="XYZM"),t}function er(i){let t;return i=="XY"?t=2:i=="XYZ"||i=="XYM"?t=3:i=="XYZM"&&(t=4),t}var Lt=Be;function nr(i,t,e,n,r,o,s){let a=i[t],l=i[t+1],h=i[e]-a,u=i[e+1]-l,c;if(h===0&&u===0)c=t;else{let d=((r-a)*h+(o-l)*u)/(h*h+u*u);if(d>1)c=e;else if(d>0){for(let f=0;f<n;++f)s[f]=Ci(i[t+f],i[e+f],d);s.length=n;return}else c=t}for(let d=0;d<n;++d)s[d]=i[c+d];s.length=n}function $e(i,t,e,n,r){let o=i[t],s=i[t+1];for(t+=n;t<e;t+=n){let a=i[t],l=i[t+1],h=Q(o,s,a,l);h>r&&(r=h),o=a,s=l}return r}function ir(i,t,e,n,r){for(let o=0,s=e.length;o<s;++o){let a=e[o];r=$e(i,t,a,n,r),t=a}return r}function Qe(i,t,e,n,r,o,s,a,l,h,u){if(t==e)return h;let c,d;if(r===0){if(d=Q(s,a,i[t],i[t+1]),d<h){for(c=0;c<n;++c)l[c]=i[t+c];return l.length=n,d}return h}u=u||[NaN,NaN];let f=t+n;for(;f<e;)if(nr(i,f-n,f,n,s,a,u),d=Q(s,a,u[0],u[1]),d<h){for(h=d,c=0;c<n;++c)l[c]=u[c];l.length=n,f+=n}else f+=n*Math.max((Math.sqrt(d)-Math.sqrt(h))/r|0,1);if(o&&(nr(i,e-n,t,n,s,a,u),d=Q(s,a,u[0],u[1]),d<h)){for(h=d,c=0;c<n;++c)l[c]=u[c];l.length=n}return h}function rr(i,t,e,n,r,o,s,a,l,h,u){u=u||[NaN,NaN];for(let c=0,d=e.length;c<d;++c){let f=e[c];h=Qe(i,t,f,n,r,o,s,a,l,h,u),t=f}return h}function or(i,t,e,n){for(let r=0,o=e.length;r<o;++r)i[t++]=e[r];return t}function Je(i,t,e,n){for(let r=0,o=e.length;r<o;++r){let s=e[r];for(let a=0;a<n;++a)i[t++]=s[a]}return t}function sr(i,t,e,n,r){r=r||[];let o=0;for(let s=0,a=e.length;s<a;++s){let l=Je(i,t,e[s],n);r[o++]=l,t=l}return r.length=o,r}function ar(i,t,e,n,r,o,s){let a=(e-t)/n;if(a<3){for(;t<e;t+=n)o[s++]=i[t],o[s++]=i[t+1];return s}let l=new Array(a);l[0]=1,l[a-1]=1;let h=[t,e-n],u=0;for(;h.length>0;){let c=h.pop(),d=h.pop(),f=0,m=i[d],g=i[d+1],p=i[c],v=i[c+1];for(let y=d+n;y<c;y+=n){let q=i[y],C=i[y+1],P=xi(q,C,m,g,p,v);P>f&&(u=y,f=P)}f>r&&(l[(u-t)/n]=1,d+n<u&&h.push(d,u),u+n<c&&h.push(u,c))}for(let c=0;c<a;++c)l[c]&&(o[s++]=i[t+c*n],o[s++]=i[t+c*n+1]);return s}function Mt(i,t){return t*Math.round(i/t)}function Uo(i,t,e,n,r,o,s){if(t==e)return s;let a=Mt(i[t],r),l=Mt(i[t+1],r);t+=n,o[s++]=a,o[s++]=l;let h,u;do if(h=Mt(i[t],r),u=Mt(i[t+1],r),t+=n,t==e)return o[s++]=h,o[s++]=u,s;while(h==a&&u==l);for(;t<e;){let c=Mt(i[t],r),d=Mt(i[t+1],r);if(t+=n,c==h&&d==u)continue;let f=h-a,m=u-l,g=c-a,p=d-l;if(f*p==m*g&&(f<0&&g<f||f==g||f>0&&g>f)&&(m<0&&p<m||m==p||m>0&&p>m)){h=c,u=d;continue}o[s++]=h,o[s++]=u,a=h,l=u,h=c,u=d}return o[s++]=h,o[s++]=u,s}function lr(i,t,e,n,r,o,s,a){for(let l=0,h=e.length;l<h;++l){let u=e[l];s=Uo(i,t,u,n,r,o,s),a.push(s),t=u}return s}function tn(i,t,e,n,r){r=r!==void 0?r:[];let o=0;for(let s=t;s<e;s+=n)r[o++]=i.slice(s,s+n);return r.length=o,r}function hr(i,t,e,n,r){r=r!==void 0?r:[];let o=0;for(let s=0,a=e.length;s<a;++s){let l=e[s];r[o++]=tn(i,t,l,n,r[o]),t=l}return r.length=o,r}function en(i,t,e,n){let r=0,o=i[e-n],s=i[e-n+1];for(;t<e;t+=n){let a=i[t],l=i[t+1];r+=s*a-o*l,o=a,s=l}return r/2}function ur(i,t,e,n){let r=0;for(let o=0,s=e.length;o<s;++o){let a=e[o];r+=en(i,t,a,n),t=a}return r}var nn=class i extends Lt{constructor(t,e){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,e!==void 0&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}clone(){return new i(this.flatCoordinates.slice(),this.layout)}closestPointXY(t,e,n,r){return r<ae(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt($e(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Qe(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,n,r))}getArea(){return en(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return tn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(t){let e=[];return e.length=ar(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new i(e,"XY")}getType(){return"LinearRing"}intersectsExtent(t){return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Je(this.flatCoordinates,0,t,this.stride),this.changed()}},rn=nn;var on=class i extends Lt{constructor(t,e){super(),this.setCoordinates(t,e)}clone(){let t=new i(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,n,r){let o=this.flatCoordinates,s=Q(t,e,o[0],o[1]);if(s<r){let a=this.stride;for(let l=0;l<a;++l)n[l]=o[l];return n.length=a,s}return r}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(t){return ci(this.flatCoordinates,t)}getType(){return"Point"}intersectsExtent(t){return ui(t,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=or(this.flatCoordinates,0,t,this.stride),this.changed()}},cr=on;function dr(i,t,e,n,r){return!fi(r,function(s){return!ot(i,t,e,n,s[0],s[1])})}function ot(i,t,e,n,r,o){let s=0,a=i[e-n],l=i[e-n+1];for(;t<e;t+=n){let h=i[t],u=i[t+1];l<=o?u>o&&(h-a)*(o-l)-(r-a)*(u-l)>0&&s++:u<=o&&(h-a)*(o-l)-(r-a)*(u-l)<0&&s--,a=h,l=u}return s!==0}function me(i,t,e,n,r,o){if(e.length===0||!ot(i,t,e[0],n,r,o))return!1;for(let s=1,a=e.length;s<a;++s)if(ot(i,e[s-1],e[s],n,r,o))return!1;return!0}function fr(i,t,e,n,r,o,s){let a,l,h,u,c,d,f,m=r[o+1],g=[];for(let y=0,q=e.length;y<q;++y){let C=e[y];for(u=i[C-n],d=i[C-n+1],a=t;a<C;a+=n)c=i[a],f=i[a+1],(m<=d&&f<=m||d<=m&&m<=f)&&(h=(m-d)/(f-d)*(c-u)+u,g.push(h)),u=c,d=f}let p=NaN,v=-1/0;for(g.sort($n),u=g[0],a=1,l=g.length;a<l;++a){c=g[a];let y=Math.abs(c-u);y>v&&(h=(u+c)/2,me(i,t,e,n,h,m)&&(p=h,v=y)),u=c}return isNaN(p)&&(p=r[o]),s?(s.push(p,m,v),s):[p,m,v]}function mr(i,t,e,n,r){let o;for(t+=n;t<e;t+=n)if(o=r(i.slice(t-n,t),i.slice(t,t+n)),o)return o;return!1}function gr(i,t,e,n,r){let o=be(Kt(),i,t,e,n);return Gt(r,o)?hi(r,o)||o[0]>=r[0]&&o[2]<=r[2]||o[1]>=r[1]&&o[3]<=r[3]?!0:mr(i,t,e,n,function(s,a){return pi(r,s,a)}):!1}function Zo(i,t,e,n,r){return!!(gr(i,t,e,n,r)||ot(i,t,e,n,r[0],r[1])||ot(i,t,e,n,r[0],r[3])||ot(i,t,e,n,r[2],r[1])||ot(i,t,e,n,r[2],r[3]))}function pr(i,t,e,n,r){if(!Zo(i,t,e[0],n,r))return!1;if(e.length===1)return!0;for(let o=1,s=e.length;o<s;++o)if(dr(i,e[o-1],e[o],n,r)&&!gr(i,e[o-1],e[o],n,r))return!1;return!0}function _r(i,t,e,n){for(;t<e-n;){for(let r=0;r<n;++r){let o=i[t+r];i[t+r]=i[e-n+r],i[e-n+r]=o}t+=n,e-=n}}function yr(i,t,e,n){let r=0,o=i[e-n],s=i[e-n+1];for(;t<e;t+=n){let a=i[t],l=i[t+1];r+=(a-o)*(l+s),o=a,s=l}return r===0?void 0:r>0}function Er(i,t,e,n,r){r=r!==void 0?r:!1;for(let o=0,s=e.length;o<s;++o){let a=e[o],l=yr(i,t,a,n);if(o===0){if(r&&l||!r&&!l)return!1}else if(r&&!l||!r&&l)return!1;t=a}return!0}function sn(i,t,e,n,r){r=r!==void 0?r:!1;for(let o=0,s=e.length;o<s;++o){let a=e[o],l=yr(i,t,a,n);(o===0?r&&l||!r&&!l:r&&!l||!r&&l)&&_r(i,t,a,n),t=a}return t}var ge=class i extends Lt{constructor(t,e,n){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,e!==void 0&&n?(this.setFlatCoordinates(e,t),this.ends_=n):this.setCoordinates(t,e)}appendLinearRing(t){this.flatCoordinates?Qn(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){let t=new i(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,n,r){return r<ae(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(ir(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),rr(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,n,r))}containsXY(t,e){return me(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)}getArea(){return ur(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(t){let e;return t!==void 0?(e=this.getOrientedFlatCoordinates().slice(),sn(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,hr(e,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){let t=ft(this.getExtent());this.flatInteriorPoint_=fr(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new cr(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(t){return t<0||this.ends_.length<=t?null:new rn(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLinearRings(){let t=this.layout,e=this.flatCoordinates,n=this.ends_,r=[],o=0;for(let s=0,a=n.length;s<a;++s){let l=n[s],h=new rn(e.slice(o,l),t);r.push(h),o=l}return r}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){let t=this.flatCoordinates;Er(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=sn(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){let e=[],n=[];return e.length=lr(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,n),new i(e,"XY",n)}getType(){return"Polygon"}intersectsExtent(t){return pr(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);let n=sr(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=n.length===0?0:n[n.length-1],this.changed()}},xr=ge;function an(i){if(mt(i))throw new Error("Cannot create polygon from empty extent");let t=i[0],e=i[1],n=i[2],r=i[3],o=[t,e,t,r,n,r,n,e,t,e];return new ge(o,"XY",[o.length])}var ln=0,un=class extends M{constructor(t){super(),this.on,this.once,this.un,t=Object.assign({},t),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=fe(t.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,t.projection&&ki(),t.center&&(t.center=G(t.center,this.projection_)),t.extent&&(t.extent=Wt(t.extent,this.projection_)),this.applyOptions_(t)}applyOptions_(t){let e=Object.assign({},t);for(let a in k)delete e[a];this.setProperties(e,!0);let n=Ho(t);this.maxResolution_=n.maxResolution,this.minResolution_=n.minResolution,this.zoomFactor_=n.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=n.minZoom;let r=Xo(t),o=n.constraint,s=Wo(t);this.constraints_={center:r,resolution:o,rotation:s},this.setRotation(t.rotation!==void 0?t.rotation:0),this.setCenterInternal(t.center!==void 0?t.center:null),t.resolution!==void 0?this.setResolution(t.resolution):t.zoom!==void 0&&this.setZoom(t.zoom)}get padding(){return this.padding_}set padding(t){let e=this.padding_;this.padding_=t;let n=this.getCenterInternal();if(n){let r=t||[0,0,0,0];e=e||[0,0,0,0];let o=this.getResolution(),s=o/2*(r[3]-e[3]+e[1]-r[1]),a=o/2*(r[0]-e[0]+e[2]-r[2]);this.setCenterInternal([n[0]+s,n[1]-a])}}getUpdatedOptions_(t){let e=this.getProperties();return e.resolution!==void 0?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),Object.assign({},e,t)}animate(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);let e=new Array(arguments.length);for(let n=0;n<e.length;++n){let r=arguments[n];r.center&&(r=Object.assign({},r),r.center=G(r.center,this.getProjection())),r.anchor&&(r=Object.assign({},r),r.anchor=G(r.anchor,this.getProjection())),e[n]=r}this.animateInternal.apply(this,e)}animateInternal(t){let e=arguments.length,n;e>1&&typeof arguments[e-1]=="function"&&(n=arguments[e-1],--e);let r=0;for(;r<e&&!this.isDef();++r){let u=arguments[r];u.center&&this.setCenterInternal(u.center),u.zoom!==void 0?this.setZoom(u.zoom):u.resolution&&this.setResolution(u.resolution),u.rotation!==void 0&&this.setRotation(u.rotation)}if(r===e){n&&pe(n,!0);return}let o=Date.now(),s=this.targetCenter_.slice(),a=this.targetResolution_,l=this.targetRotation_,h=[];for(;r<e;++r){let u=arguments[r],c={start:o,complete:!1,anchor:u.anchor,duration:u.duration!==void 0?u.duration:1e3,easing:u.easing||Yi,callback:n};if(u.center&&(c.sourceCenter=s,c.targetCenter=u.center.slice(),s=c.targetCenter),u.zoom!==void 0?(c.sourceResolution=a,c.targetResolution=this.getResolutionForZoom(u.zoom),a=c.targetResolution):u.resolution&&(c.sourceResolution=a,c.targetResolution=u.resolution,a=c.targetResolution),u.rotation!==void 0){c.sourceRotation=l;let d=Ne(u.rotation-l+Math.PI,2*Math.PI)-Math.PI;c.targetRotation=l+d,l=c.targetRotation}jo(c)?c.complete=!0:o+=c.duration,h.push(c)}this.animations_.push(h),this.setHint(N.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[N.ANIMATING]>0}getInteracting(){return this.hints_[N.INTERACTING]>0}cancelAnimations(){this.setHint(N.ANIMATING,-this.hints_[N.ANIMATING]);let t;for(let e=0,n=this.animations_.length;e<n;++e){let r=this.animations_[e];if(r[0].callback&&pe(r[0].callback,!1),!t)for(let o=0,s=r.length;o<s;++o){let a=r[o];if(!a.complete){t=a.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;let t=Date.now(),e=!1;for(let n=this.animations_.length-1;n>=0;--n){let r=this.animations_[n],o=!0;for(let s=0,a=r.length;s<a;++s){let l=r[s];if(l.complete)continue;let h=t-l.start,u=l.duration>0?h/l.duration:1;u>=1?(l.complete=!0,u=1):o=!1;let c=l.easing(u);if(l.sourceCenter){let d=l.sourceCenter[0],f=l.sourceCenter[1],m=l.targetCenter[0],g=l.targetCenter[1];this.nextCenter_=l.targetCenter;let p=d+c*(m-d),v=f+c*(g-f);this.targetCenter_=[p,v]}if(l.sourceResolution&&l.targetResolution){let d=c===1?l.targetResolution:l.sourceResolution+c*(l.targetResolution-l.sourceResolution);if(l.anchor){let f=this.getViewportSize_(this.getRotation()),m=this.constraints_.resolution(d,0,f,!0);this.targetCenter_=this.calculateCenterZoom(m,l.anchor)}this.nextResolution_=l.targetResolution,this.targetResolution_=d,this.applyTargetState_(!0)}if(l.sourceRotation!==void 0&&l.targetRotation!==void 0){let d=c===1?Ne(l.targetRotation+Math.PI,2*Math.PI)-Math.PI:l.sourceRotation+c*(l.targetRotation-l.sourceRotation);if(l.anchor){let f=this.constraints_.rotation(d,!0);this.targetCenter_=this.calculateCenterRotate(f,l.anchor)}this.nextRotation_=l.targetRotation,this.targetRotation_=d}if(this.applyTargetState_(!0),e=!0,!l.complete)break}if(o){this.animations_[n]=null,this.setHint(N.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;let s=r[0].callback;s&&pe(s,!0)}}this.animations_=this.animations_.filter(Boolean),e&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(t,e){let n,r=this.getCenterInternal();return r!==void 0&&(n=[r[0]-e[0],r[1]-e[1]],It(n,t-this.getRotation()),Pi(n,e)),n}calculateCenterZoom(t,e){let n,r=this.getCenterInternal(),o=this.getResolution();if(r!==void 0&&o!==void 0){let s=e[0]-t*(e[0]-r[0])/o,a=e[1]-t*(e[1]-r[1])/o;n=[s,a]}return n}getViewportSize_(t){let e=this.viewportSize_;if(t){let n=e[0],r=e[1];return[Math.abs(n*Math.cos(t))+Math.abs(r*Math.sin(t)),Math.abs(n*Math.sin(t))+Math.abs(r*Math.cos(t))]}return e}setViewportSize(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){let t=this.getCenterInternal();return t&&Ht(t,this.getProjection())}getCenterInternal(){return this.get(k.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(t){return t!==void 0?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()}calculateExtent(t){let e=this.calculateExtentInternal(t);return Ui(e,this.getProjection())}calculateExtentInternal(t){t=t||this.getViewportSizeMinusPadding_();let e=this.getCenterInternal();I(e,"The view center is not defined");let n=this.getResolution();I(n!==void 0,"The view resolution is not defined");let r=this.getRotation();return I(r!==void 0,"The view rotation is not defined"),zt(e,n,r,t)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))}setConstrainResolution(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))}getProjection(){return this.projection_}getResolution(){return this.get(k.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(t,e){return this.getResolutionForExtentInternal(Wt(t,this.getProjection()),e)}getResolutionForExtentInternal(t,e){e=e||this.getViewportSizeMinusPadding_();let n=z(t)/e[0],r=it(t)/e[1];return Math.max(n,r)}getResolutionForValueFunction(t){t=t||2;let e=this.getConstrainedResolution(this.maxResolution_),n=this.minResolution_,r=Math.log(e/n)/Math.log(t);return function(o){return e/Math.pow(t,o*r)}}getRotation(){return this.get(k.ROTATION)}getValueForResolutionFunction(t){let e=Math.log(t||2),n=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,o=Math.log(n/r)/e;return function(s){return Math.log(n/s)/e/o}}getViewportSizeMinusPadding_(t){let e=this.getViewportSize_(t),n=this.padding_;return n&&(e=[e[0]-n[1]-n[3],e[1]-n[0]-n[2]]),e}getState(){let t=this.getProjection(),e=this.getResolution(),n=this.getRotation(),r=this.getCenterInternal(),o=this.padding_;if(o){let s=this.getViewportSizeMinusPadding_();r=hn(r,this.getViewportSize_(),[s[0]/2+o[3],s[1]/2+o[0]],e,n)}return{center:r.slice(0),projection:t!==void 0?t:null,resolution:e,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:n,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let t,e=this.getResolution();return e!==void 0&&(t=this.getZoomForResolution(e)),t}getZoomForResolution(t){let e=this.minZoom_||0,n,r;if(this.resolutions_){let o=ee(this.resolutions_,t,1);e=o,n=this.resolutions_[o],o==this.resolutions_.length-1?r=2:r=n/this.resolutions_[o+1]}else n=this.maxResolution_,r=this.zoomFactor_;return e+Math.log(n/t)/Math.log(r)}getResolutionForZoom(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;let e=S(Math.floor(t),0,this.resolutions_.length-2),n=this.resolutions_[e]/this.resolutions_[e+1];return this.resolutions_[e]/Math.pow(n,S(t-e,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}fit(t,e){let n;if(I(Array.isArray(t)||typeof t.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(t)){I(!mt(t),"Cannot fit empty extent provided as `geometry`");let r=Wt(t,this.getProjection());n=an(r)}else if(t.getType()==="Circle"){let r=Wt(t.getExtent(),this.getProjection());n=an(r),n.rotate(this.getRotation(),ft(r))}else{let r=Vi();r?n=t.clone().transform(r,this.getProjection()):n=t}this.fitInternal(n,e)}rotatedExtentForGeometry(t){let e=this.getRotation(),n=Math.cos(e),r=Math.sin(-e),o=t.getFlatCoordinates(),s=t.getStride(),a=1/0,l=1/0,h=-1/0,u=-1/0;for(let c=0,d=o.length;c<d;c+=s){let f=o[c]*n-o[c+1]*r,m=o[c]*r+o[c+1]*n;a=Math.min(a,f),l=Math.min(l,m),h=Math.max(h,f),u=Math.max(u,m)}return[a,l,h,u]}fitInternal(t,e){e=e||{};let n=e.size;n||(n=this.getViewportSizeMinusPadding_());let r=e.padding!==void 0?e.padding:[0,0,0,0],o=e.nearest!==void 0?e.nearest:!1,s;e.minResolution!==void 0?s=e.minResolution:e.maxZoom!==void 0?s=this.getResolutionForZoom(e.maxZoom):s=0;let a=this.rotatedExtentForGeometry(t),l=this.getResolutionForExtentInternal(a,[n[0]-r[1]-r[3],n[1]-r[0]-r[2]]);l=isNaN(l)?s:Math.max(l,s),l=this.getConstrainedResolution(l,o?0:1);let h=this.getRotation(),u=Math.sin(h),c=Math.cos(h),d=ft(a);d[0]+=(r[1]-r[3])/2*l,d[1]+=(r[0]-r[2])/2*l;let f=d[0]*c-d[1]*u,m=d[1]*c+d[0]*u,g=this.getConstrainedCenter([f,m],l),p=e.callback?e.callback:ut;e.duration!==void 0?this.animateInternal({resolution:l,center:g,duration:e.duration,easing:e.easing},p):(this.targetResolution_=l,this.targetCenter_=g,this.applyTargetState_(!1,!0),pe(p,!0))}centerOn(t,e,n){this.centerOnInternal(G(t,this.getProjection()),e,n)}centerOnInternal(t,e,n){this.setCenterInternal(hn(t,e,n,this.getResolution(),this.getRotation()))}calculateCenterShift(t,e,n,r){let o,s=this.padding_;if(s&&t){let a=this.getViewportSizeMinusPadding_(-n),l=hn(t,r,[a[0]/2+s[3],a[1]/2+s[0]],e,n);o=[t[0]-l[0],t[1]-l[1]]}return o}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(t){let e=Ht(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])}adjustCenterInternal(t){let e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])}adjustResolution(t,e){e=e&&G(e,this.getProjection()),this.adjustResolutionInternal(t,e)}adjustResolutionInternal(t,e){let n=this.getAnimating()||this.getInteracting(),r=this.getViewportSize_(this.getRotation()),o=this.constraints_.resolution(this.targetResolution_*t,0,r,n);e&&(this.targetCenter_=this.calculateCenterZoom(o,e)),this.targetResolution_*=t,this.applyTargetState_()}adjustZoom(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)}adjustRotation(t,e){e&&(e=G(e,this.getProjection())),this.adjustRotationInternal(t,e)}adjustRotationInternal(t,e){let n=this.getAnimating()||this.getInteracting(),r=this.constraints_.rotation(this.targetRotation_+t,n);e&&(this.targetCenter_=this.calculateCenterRotate(r,e)),this.targetRotation_+=t,this.applyTargetState_()}setCenter(t){this.setCenterInternal(t&&G(t,this.getProjection()))}setCenterInternal(t){this.targetCenter_=t,this.applyTargetState_()}setHint(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]}setResolution(t){this.targetResolution_=t,this.applyTargetState_()}setRotation(t){this.targetRotation_=t,this.applyTargetState_()}setZoom(t){this.setResolution(this.getResolutionForZoom(t))}applyTargetState_(t,e){let n=this.getAnimating()||this.getInteracting()||e,r=this.constraints_.rotation(this.targetRotation_,n),o=this.getViewportSize_(r),s=this.constraints_.resolution(this.targetResolution_,0,o,n),a=this.constraints_.center(this.targetCenter_,s,o,n,this.calculateCenterShift(this.targetCenter_,s,r,o));this.get(k.ROTATION)!==r&&this.set(k.ROTATION,r),this.get(k.RESOLUTION)!==s&&(this.set(k.RESOLUTION,s),this.set("zoom",this.getZoom(),!0)),(!a||!this.get(k.CENTER)||!pt(this.get(k.CENTER),a))&&this.set(k.CENTER,a),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(t,e,n){t=t!==void 0?t:200;let r=e||0,o=this.constraints_.rotation(this.targetRotation_),s=this.getViewportSize_(o),a=this.constraints_.resolution(this.targetResolution_,r,s),l=this.constraints_.center(this.targetCenter_,a,s,!1,this.calculateCenterShift(this.targetCenter_,a,o,s));if(t===0&&!this.cancelAnchor_){this.targetResolution_=a,this.targetRotation_=o,this.targetCenter_=l,this.applyTargetState_();return}n=n||(t===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==a||this.getRotation()!==o||!this.getCenterInternal()||!pt(this.getCenterInternal(),l))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:o,center:l,resolution:a,duration:t,easing:K,anchor:n}))}beginInteraction(){this.resolveConstraints(0),this.setHint(N.INTERACTING,1)}endInteraction(t,e,n){n=n&&G(n,this.getProjection()),this.endInteractionInternal(t,e,n)}endInteractionInternal(t,e,n){this.getInteracting()&&(this.setHint(N.INTERACTING,-1),this.resolveConstraints(t,e,n))}getConstrainedCenter(t,e){let n=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),n)}getConstrainedZoom(t,e){let n=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(n,e))}getConstrainedResolution(t,e){e=e||0;let n=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,e,n)}};function pe(i,t){setTimeout(function(){i(t)},0)}function Xo(i){if(i.extent!==void 0){let e=i.smoothExtentConstraint!==void 0?i.smoothExtentConstraint:!0;return Ze(i.extent,i.constrainOnlyCenter,e)}let t=fe(i.projection,"EPSG:3857");if(i.multiWorld!==!0&&t.isGlobal()){let e=t.getExtent().slice();return e[0]=-1/0,e[2]=1/0,Ze(e,!1,!1)}return Zi}function Ho(i){let t,e,n,s=i.minZoom!==void 0?i.minZoom:ln,a=i.maxZoom!==void 0?i.maxZoom:28,l=i.zoomFactor!==void 0?i.zoomFactor:2,h=i.multiWorld!==void 0?i.multiWorld:!1,u=i.smoothResolutionConstraint!==void 0?i.smoothResolutionConstraint:!0,c=i.showFullExtent!==void 0?i.showFullExtent:!1,d=fe(i.projection,"EPSG:3857"),f=d.getExtent(),m=i.constrainOnlyCenter,g=i.extent;if(!h&&!g&&d.isGlobal()&&(m=!1,g=f),i.resolutions!==void 0){let p=i.resolutions;e=p[s],n=p[a]!==void 0?p[a]:p[p.length-1],i.constrainResolution?t=Xi(p,u,!m&&g,c):t=We(e,n,u,!m&&g,c)}else{let v=(f?Math.max(z(f),it(f)):360*Vt.degrees/d.getMetersPerUnit())/256/Math.pow(2,ln),y=v/Math.pow(2,28-ln);e=i.maxResolution,e!==void 0?s=0:e=v/Math.pow(l,s),n=i.minResolution,n===void 0&&(i.maxZoom!==void 0?i.maxResolution!==void 0?n=e/Math.pow(l,a):n=v/Math.pow(l,a):n=y),a=s+Math.floor(Math.log(e/n)/Math.log(l)),n=e/Math.pow(l,a-s),i.constrainResolution?t=Hi(l,e,n,u,!m&&g,c):t=We(e,n,u,!m&&g,c)}return{constraint:t,maxResolution:e,minResolution:n,minZoom:s,zoomFactor:l}}function Wo(i){if(i.enableRotation!==void 0?i.enableRotation:!0){let e=i.constrainRotation;return e===void 0||e===!0?ji():e===!1?je:typeof e=="number"?Wi(e):je}return At}function jo(i){return!(i.sourceCenter&&i.targetCenter&&!pt(i.sourceCenter,i.targetCenter)||i.sourceResolution!==i.targetResolution||i.sourceRotation!==i.targetRotation)}function hn(i,t,e,n,r){let o=Math.cos(-r),s=Math.sin(-r),a=i[0]*o-i[1]*s,l=i[1]*o+i[0]*s;a+=(t[0]/2-e[0])*n,l+=(e[1]-t[1]/2)*n,s=-s;let h=a*o-l*s,u=l*o+a*s;return[h,u]}var V=un;var cn=class extends he{constructor(t){let e=Object.assign({},t);delete e.source,super(e),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,t.render&&(this.render=t.render),t.map&&this.setMap(t.map),this.addChangeListener(x.SOURCE,this.handleSourcePropertyChange_);let n=t.source?t.source:null;this.setSource(n)}getLayersArray(t){return t=t||[],t.push(this),t}getLayerStatesArray(t){return t=t||[],t.push(this.getLayerState()),t}getSource(){return this.get(x.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){let t=this.getSource();return t?t.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(w(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;let t=this.getSource();t&&(this.sourceChangeKey_=E(t,_.CHANGE,this.handleSourceChange_,this),t.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(t){return this.renderer_?this.renderer_.getFeatures(t):Promise.resolve([])}getData(t){return!this.renderer_||!this.rendered?null:this.renderer_.getData(t)}isVisible(t){let e,n=this.getMapInternal();!t&&n&&(t=n.getView()),t instanceof V?e={viewState:t.getState(),extent:t.calculateExtent()}:e=t,!e.layerStatesArray&&n&&(e.layerStatesArray=n.getLayerGroup().getLayerStatesArray());let r;e.layerStatesArray?r=e.layerStatesArray.find(s=>s.layer===this):r=this.getLayerState();let o=this.getExtent();return jt(r,e.viewState)&&(!o||Gt(o,e.extent))}getAttributions(t){if(!this.isVisible(t))return[];let e,n=this.getSource();if(n&&(e=n.getAttributions()),!e)return[];let r=t instanceof V?t.getViewStateAndExtent():t,o=e(r);return Array.isArray(o)||(o=[o]),o}render(t,e){let n=this.getRenderer();return n.prepareFrame(t)?(this.rendered=!0,n.renderFrame(t,e)):null}unrender(){this.rendered=!1}setMapInternal(t){t||this.unrender(),this.set(x.MAP,t)}getMapInternal(){return this.get(x.MAP)}setMap(t){this.mapPrecomposeKey_&&(w(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(w(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=E(t,J.PRECOMPOSE,function(e){let r=e.frameState.layerStatesArray,o=this.getLayerState(!1);I(!r.some(function(s){return s.layer===o.layer}),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),r.push(o)},this),this.mapRenderKey_=E(this,_.CHANGE,t.render,t),this.changed())}setSource(t){this.set(x.SOURCE,t)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}disposeInternal(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),super.disposeInternal()}};function jt(i,t){if(!i.visible)return!1;let e=t.resolution;if(e<i.minResolution||e>=i.maxResolution)return!1;let n=t.zoom;return n>i.minZoom&&n<=i.maxZoom}var dn=cn;var fn=class extends yt{constructor(t){super(),this.map_=t}dispatchRenderEvent(t,e){T()}calculateMatrices2D(t){let e=t.viewState,n=t.coordinateToPixelTransform,r=t.pixelToCoordinateTransform;se(n,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),si(r,n)}forEachFeatureAtCoordinate(t,e,n,r,o,s,a,l){let h,u=e.viewState;function c(C,P,Ft,_t){return o.call(s,P,C?Ft:null,_t)}let d=u.projection,f=Oi(t.slice(),d),m=[[0,0]];if(d.canWrapX()&&r){let C=d.getExtent(),P=z(C);m.push([-P,0],[P,0])}let g=e.layerStatesArray,p=g.length,v=[],y=[];for(let C=0;C<m.length;C++)for(let P=p-1;P>=0;--P){let Ft=g[P],_t=Ft.layer;if(_t.hasRenderer()&&jt(Ft,u)&&a.call(l,_t)){let jn=_t.getRenderer(),Yn=_t.getSource();if(jn&&Yn){let qn=Yn.getWrapX()?f:t,so=c.bind(null,Ft.managed);y[0]=qn[0]+m[C][0],y[1]=qn[1]+m[C][1],h=jn.forEachFeatureAtCoordinate(y,e,n,so,v)}if(h)return h}}if(v.length===0)return;let q=1/v.length;return v.forEach((C,P)=>C.distanceSq+=P*q),v.sort((C,P)=>C.distanceSq-P.distanceSq),v.some(C=>h=C.callback(C.feature,C.layer,C.geometry)),h}hasFeatureAtCoordinate(t,e,n,r,o,s){return this.forEachFeatureAtCoordinate(t,e,n,r,ht,this,o,s)!==void 0}getMap(){return this.map_}renderFrame(t){T()}flushDeclutterItems(t){}scheduleExpireIconCache(t){Fe.canExpireCache()&&t.postRenderFunctions.push(Yo)}};function Yo(i,t){Fe.expire()}var vr=fn;var mn=class extends O{constructor(t,e,n,r){super(t),this.inversePixelTransform=e,this.frameState=n,this.context=r}},Cr=mn;var Yt="ol-hidden";var st="ol-unselectable";var St="ol-control",gn="ol-collapsed",qo=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z]+?)\\s*$`].join(""),"i"),Rr=["style","variant","weight","size","lineHeight","family"],wr=function(i){let t=i.match(qo);if(!t)return null;let e={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"};for(let n=0,r=Rr.length;n<r;++n){let o=t[n+1];o!==void 0&&(e[Rr[n]]=o)}return e.families=e.family.split(/,\s?/),e};function Ir(i,t,e,n){let r;return e&&e.length?r=e.shift():oi?r=new OffscreenCanvas(i||300,t||300):r=document.createElement("canvas"),i&&(r.width=i),t&&(r.height=t),r.getContext("2d",n)}function pn(i,t){let e=t.parentNode;e&&e.replaceChild(i,t)}function qt(i){return i&&i.parentNode?i.parentNode.removeChild(i):null}function Tr(i){for(;i.lastChild;)i.removeChild(i.lastChild)}function Ar(i,t){let e=i.childNodes;for(let n=0;;++n){let r=e[n],o=t[n];if(!r&&!o)break;if(r!==o){if(!r){i.appendChild(o);continue}if(!o){i.removeChild(r),--n;continue}i.insertBefore(o,r)}}}var X=new M,Pt=null,_n,Bo={},nu=function(){let t="32px ",e=["monospace","serif"],n=e.length,r="wmytzilWMYTZIL@#/&?$%10\uF013",o,s;function a(h,u,c){let d=!0;for(let f=0;f<n;++f){let m=e[f];if(s=Lr(h+" "+u+" "+t+m,r),c!=m){let g=Lr(h+" "+u+" "+t+c+","+m,r);d=d&&g!=s}}return!!d}function l(){let h=!0,u=X.getKeys();for(let c=0,d=u.length;c<d;++c){let f=u[c];X.get(f)<100&&(a.apply(this,f.split(`
`))?(Z(Bo),Pt=null,_n=void 0,X.set(f,100)):(X.set(f,X.get(f)+1,!0),h=!1))}h&&(clearInterval(o),o=void 0)}return function(h){let u=wr(h);if(!u)return;let c=u.families;for(let d=0,f=c.length;d<f;++d){let m=c[d],g=u.style+`
`+u.weight+`
`+m;X.get(g)===void 0&&(X.set(g,100,!0),a(u.style,u.weight,m)||(X.set(g,0,!0),o===void 0&&(o=setInterval(l,32))))}}}();function $o(i,t){return Pt||(Pt=Ir(1,1)),i!=_n&&(Pt.font=i,_n=Pt.font),Pt.measureText(t)}function Lr(i,t){return $o(i,t).width}var yn=class extends vr{constructor(t){super(t),this.fontChangeListenerKey_=E(X,B.PROPERTYCHANGE,t.redrawText.bind(t)),this.element_=document.createElement("div");let e=this.element_.style;e.position="absolute",e.width="100%",e.height="100%",e.zIndex="0",this.element_.className=st+" ol-layers";let n=t.getViewport();n.insertBefore(this.element_,n.firstChild||null),this.children_=[],this.renderedVisible_=!0,this.declutterLayers_=[]}dispatchRenderEvent(t,e){let n=this.getMap();if(n.hasListener(t)){let r=new Cr(t,void 0,e);n.dispatchEvent(r)}}disposeInternal(){w(this.fontChangeListenerKey_),this.element_.parentNode.removeChild(this.element_),super.disposeInternal()}renderFrame(t){if(!t){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(t),this.dispatchRenderEvent(J.PRECOMPOSE,t);let e=t.layerStatesArray.sort(function(s,a){return s.zIndex-a.zIndex}),n=t.viewState;this.children_.length=0;let r=this.declutterLayers_;r.length=0;let o=null;for(let s=0,a=e.length;s<a;++s){let l=e[s];t.layerIndex=s;let h=l.layer,u=h.getSourceState();if(!jt(l,n)||u!="ready"&&u!="undefined"){h.unrender();continue}let c=h.render(t,o);c&&(c!==o&&(this.children_.push(c),o=c),"getDeclutter"in h&&r.push(h))}this.flushDeclutterItems(t),Ar(this.element_,this.children_),this.dispatchRenderEvent(J.POSTCOMPOSE,t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)}flushDeclutterItems(t){let e=this.declutterLayers_;for(let n=e.length-1;n>=0;--n)e[n].renderDeclutter(t);e.length=0}},Mr=yn;var U=class extends O{constructor(t,e){super(t),this.layer=e}},En={LAYERS:"layers"},xn=class i extends he{constructor(t){t=t||{};let e=Object.assign({},t);delete e.layers;let n=t.layers;super(e),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(En.LAYERS,this.handleLayersChanged_),n?Array.isArray(n)?n=new D(n.slice(),{unique:!0}):I(typeof n.getArray=="function","Expected `layers` to be an array or a `Collection`"):n=new D(void 0,{unique:!0}),this.setLayers(n)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(w),this.layersListenerKeys_.length=0;let t=this.getLayers();this.layersListenerKeys_.push(E(t,b.ADD,this.handleLayersAdd_,this),E(t,b.REMOVE,this.handleLayersRemove_,this));for(let n in this.listenerKeys_)this.listenerKeys_[n].forEach(w);Z(this.listenerKeys_);let e=t.getArray();for(let n=0,r=e.length;n<r;n++){let o=e[n];this.registerLayerListeners_(o),this.dispatchEvent(new U("addlayer",o))}this.changed()}registerLayerListeners_(t){let e=[E(t,B.PROPERTYCHANGE,this.handleLayerChange_,this),E(t,_.CHANGE,this.handleLayerChange_,this)];t instanceof i&&e.push(E(t,"addlayer",this.handleLayerGroupAdd_,this),E(t,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[ct(t)]=e}handleLayerGroupAdd_(t){this.dispatchEvent(new U("addlayer",t.layer))}handleLayerGroupRemove_(t){this.dispatchEvent(new U("removelayer",t.layer))}handleLayersAdd_(t){let e=t.element;this.registerLayerListeners_(e),this.dispatchEvent(new U("addlayer",e)),this.changed()}handleLayersRemove_(t){let e=t.element,n=ct(e);this.listenerKeys_[n].forEach(w),delete this.listenerKeys_[n],this.dispatchEvent(new U("removelayer",e)),this.changed()}getLayers(){return this.get(En.LAYERS)}setLayers(t){let e=this.getLayers();if(e){let n=e.getArray();for(let r=0,o=n.length;r<o;++r)this.dispatchEvent(new U("removelayer",n[r]))}this.set(En.LAYERS,t)}getLayersArray(t){return t=t!==void 0?t:[],this.getLayers().forEach(function(e){e.getLayersArray(t)}),t}getLayerStatesArray(t){let e=t!==void 0?t:[],n=e.length;this.getLayers().forEach(function(s){s.getLayerStatesArray(e)});let r=this.getLayerState(),o=r.zIndex;!t&&r.zIndex===void 0&&(o=0);for(let s=n,a=e.length;s<a;s++){let l=e[s];l.opacity*=r.opacity,l.visible=l.visible&&r.visible,l.maxResolution=Math.min(l.maxResolution,r.maxResolution),l.minResolution=Math.max(l.minResolution,r.minResolution),l.minZoom=Math.max(l.minZoom,r.minZoom),l.maxZoom=Math.min(l.maxZoom,r.maxZoom),r.extent!==void 0&&(l.extent!==void 0?l.extent=mi(l.extent,r.extent):l.extent=r.extent),l.zIndex===void 0&&(l.zIndex=o)}return e}getSourceState(){return"ready"}},Bt=xn;var vn=class extends O{constructor(t,e,n){super(t),this.map=e,this.frameState=n!==void 0?n:null}},at=vn;var Cn=class extends at{constructor(t,e,n,r,o,s){super(t,e,o),this.originalEvent=n,this.pixel_=null,this.coordinate_=null,this.dragging=r!==void 0?r:!1,this.activePointers=s}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(t){this.pixel_=t}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(t){this.coordinate_=t}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}},H=Cn;var R={SINGLECLICK:"singleclick",CLICK:_.CLICK,DBLCLICK:_.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};var $t={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};var Rn=class extends ne{constructor(t,e){super(t),this.map_=t,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=e===void 0?1:e,this.down_=null;let n=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=n,this.pointerdownListenerKey_=E(n,$t.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=E(n,$t.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(_.TOUCHMOVE,this.boundHandleTouchMove_,oe?{passive:!1}:!1)}emulateClick_(t){let e=new H(R.CLICK,this.map_,t);this.dispatchEvent(e),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,e=new H(R.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;let n=new H(R.SINGLECLICK,this.map_,t);this.dispatchEvent(n)},250)}updateActivePointers_(t){let e=t,n=e.pointerId;if(e.type==R.POINTERUP||e.type==R.POINTERCANCEL){delete this.trackedTouches_[n];for(let r in this.trackedTouches_)if(this.trackedTouches_[r].target!==e.target){delete this.trackedTouches_[r];break}}else(e.type==R.POINTERDOWN||e.type==R.POINTERMOVE)&&(this.trackedTouches_[n]=e);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(t){this.updateActivePointers_(t);let e=new H(R.POINTERUP,this.map_,t,void 0,void 0,this.activePointers_);this.dispatchEvent(e),this.emulateClicks_&&!e.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(t)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(w),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(t){return t.button===0}handlePointerDown_(t){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(t);let e=new H(R.POINTERDOWN,this.map_,t,void 0,void 0,this.activePointers_);if(this.dispatchEvent(e),this.down_=new PointerEvent(t.type,t),Object.defineProperty(this.down_,"target",{writable:!1,value:t.target}),this.dragListenerKeys_.length===0){let n=this.map_.getOwnerDocument();this.dragListenerKeys_.push(E(n,R.POINTERMOVE,this.handlePointerMove_,this),E(n,R.POINTERUP,this.handlePointerUp_,this),E(this.element_,R.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==n&&this.dragListenerKeys_.push(E(this.element_.getRootNode(),R.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(t){if(this.isMoving_(t)){this.updateActivePointers_(t),this.dragging_=!0;let e=new H(R.POINTERDRAG,this.map_,t,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(e)}}relayMoveEvent_(t){this.originalPointerMoveEvent_=t;let e=!!(this.down_&&this.isMoving_(t));this.dispatchEvent(new H(R.POINTERMOVE,this.map_,t,e))}handleTouchMove_(t){let e=this.originalPointerMoveEvent_;(!e||e.defaultPrevented)&&(typeof t.cancelable!="boolean"||t.cancelable===!0)&&t.preventDefault()}isMoving_(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(w(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(_.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(w(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(w),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}},Sr=Rn;var W={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"};var L={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};var Qt=1/0,wn=class{constructor(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,Z(this.queuedElements_)}dequeue(){let t=this.elements_,e=this.priorities_,n=t[0];t.length==1?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));let r=this.keyFunction_(n);return delete this.queuedElements_[r],n}enqueue(t){I(!(this.keyFunction_(t)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");let e=this.priorityFunction_(t);return e!=Qt?(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(t){return t*2+1}getRightChildIndex_(t){return t*2+2}getParentIndex_(t){return t-1>>1}heapify_(){let t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)}isEmpty(){return this.elements_.length===0}isKeyQueued(t){return t in this.queuedElements_}isQueued(t){return this.isKeyQueued(this.keyFunction_(t))}siftUp_(t){let e=this.elements_,n=this.priorities_,r=e.length,o=e[t],s=n[t],a=t;for(;t<r>>1;){let l=this.getLeftChildIndex_(t),h=this.getRightChildIndex_(t),u=h<r&&n[h]<n[l]?h:l;e[t]=e[u],n[t]=n[u],t=u}e[t]=o,n[t]=s,this.siftDown_(a,t)}siftDown_(t,e){let n=this.elements_,r=this.priorities_,o=n[e],s=r[e];for(;e>t;){let a=this.getParentIndex_(e);if(r[a]>s)n[e]=n[a],r[e]=r[a],e=a;else break}n[e]=o,r[e]=s}reprioritize(){let t=this.priorityFunction_,e=this.elements_,n=this.priorities_,r=0,o=e.length,s,a,l;for(a=0;a<o;++a)s=e[a],l=t(s),l==Qt?delete this.queuedElements_[this.keyFunction_(s)]:(n[r]=l,e[r++]=s);e.length=r,n.length=r,this.heapify_()}},Pr=wn;var bt={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};var In=class extends Pr{constructor(t,e){super(function(n){return t.apply(null,n)},function(n){return n[0].getKey()}),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=e,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(t){let e=super.enqueue(t);return e&&t[0].addEventListener(_.CHANGE,this.boundHandleTileChange_),e}getTilesLoading(){return this.tilesLoading_}handleTileChange(t){let e=t.target,n=e.getState();if(n===bt.LOADED||n===bt.ERROR||n===bt.EMPTY){n!==bt.ERROR&&e.removeEventListener(_.CHANGE,this.boundHandleTileChange_);let r=e.getKey();r in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[r],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(t,e){let n=0,r,o,s;for(;this.tilesLoading_<t&&n<e&&this.getCount()>0;)o=this.dequeue()[0],s=o.getKey(),r=o.getState(),r===bt.IDLE&&!(s in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++n,o.load())}},br=In;function Or(i,t,e,n,r){if(!i||!(e in i.wantedTiles))return Qt;if(!i.wantedTiles[e][t.getKey()])return Qt;let o=i.viewState.center,s=n[0]-o[0],a=n[1]-o[1];return 65536*Math.log(r)+Math.sqrt(s*s+a*a)/r}var Tn=class extends M{constructor(t){super();let e=t.element;e&&!t.target&&!e.style.pointerEvents&&(e.style.pointerEvents="auto"),this.element=e||null,this.target_=null,this.map_=null,this.listenerKeys=[],t.render&&(this.render=t.render),t.target&&this.setTarget(t.target)}disposeInternal(){qt(this.element),super.disposeInternal()}getMap(){return this.map_}setMap(t){this.map_&&qt(this.element);for(let e=0,n=this.listenerKeys.length;e<n;++e)w(this.listenerKeys[e]);this.listenerKeys.length=0,this.map_=t,t&&((this.target_?this.target_:t.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==ut&&this.listenerKeys.push(E(t,W.POSTRENDER,this.render,this)),t.render())}render(t){}setTarget(t){this.target_=typeof t=="string"?document.getElementById(t):t}},Ot=Tn;var An=class extends Ot{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=t.collapsed!==void 0?t.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=t.collapsible!==void 0,this.collapsible_=t.collapsible!==void 0?t.collapsible:!0,this.collapsible_||(this.collapsed_=!1);let e=t.className!==void 0?t.className:"ol-attribution",n=t.tipLabel!==void 0?t.tipLabel:"Attributions",r=t.expandClassName!==void 0?t.expandClassName:e+"-expand",o=t.collapseLabel!==void 0?t.collapseLabel:"\u203A",s=t.collapseClassName!==void 0?t.collapseClassName:e+"-collapse";typeof o=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=o,this.collapseLabel_.className=s):this.collapseLabel_=o;let a=t.label!==void 0?t.label:"i";typeof a=="string"?(this.label_=document.createElement("span"),this.label_.textContent=a,this.label_.className=r):this.label_=a;let l=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=n,this.toggleButton_.appendChild(l),this.toggleButton_.addEventListener(_.CLICK,this.handleClick_.bind(this),!1);let h=e+" "+st+" "+St+(this.collapsed_&&this.collapsible_?" "+gn:"")+(this.collapsible_?"":" ol-uncollapsible"),u=this.element;u.className=h,u.appendChild(this.toggleButton_),u.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(t){let e=Array.from(new Set(this.getMap().getAllLayers().flatMap(r=>r.getAttributions(t)))),n=!this.getMap().getAllLayers().some(r=>r.getSource()&&r.getSource().getAttributionsCollapsible()===!1);return this.overrideCollapsible_||this.setCollapsible(n),e}updateElement_(t){if(!t){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}let e=this.collectSourceAttributions_(t),n=e.length>0;if(this.renderedVisible_!=n&&(this.element.style.display=n?"":"none",this.renderedVisible_=n),!Et(e,this.renderedAttributions_)){Tr(this.ulElement_);for(let r=0,o=e.length;r<o;++r){let s=document.createElement("li");s.innerHTML=e[r],this.ulElement_.appendChild(s)}this.renderedAttributions_=e}}handleClick_(t){t.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(gn),this.collapsed_?pn(this.collapseLabel_,this.label_):pn(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(t){this.userCollapsed_=t,!(!this.collapsible_||this.collapsed_===t)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(t){this.updateElement_(t.frameState)}},Nr=An;var Ln=class extends Ot{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target});let e=t.className!==void 0?t.className:"ol-rotate",n=t.label!==void 0?t.label:"\u21E7",r=t.compassClassName!==void 0?t.compassClassName:"ol-compass";this.label_=null,typeof n=="string"?(this.label_=document.createElement("span"),this.label_.className=r,this.label_.textContent=n):(this.label_=n,this.label_.classList.add(r));let o=t.tipLabel?t.tipLabel:"Reset rotation",s=document.createElement("button");s.className=e+"-reset",s.setAttribute("type","button"),s.title=o,s.appendChild(this.label_),s.addEventListener(_.CLICK,this.handleClick_.bind(this),!1);let a=e+" "+st+" "+St,l=this.element;l.className=a,l.appendChild(s),this.callResetNorth_=t.resetNorth?t.resetNorth:void 0,this.duration_=t.duration!==void 0?t.duration:250,this.autoHide_=t.autoHide!==void 0?t.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(Yt)}handleClick_(t){t.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){let e=this.getMap().getView();if(!e)return;let n=e.getRotation();n!==void 0&&(this.duration_>0&&n%(2*Math.PI)!==0?e.animate({rotation:0,duration:this.duration_,easing:K}):e.setRotation(0))}render(t){let e=t.frameState;if(!e)return;let n=e.viewState.rotation;if(n!=this.rotation_){let r="rotate("+n+"rad)";if(this.autoHide_){let o=this.element.classList.contains(Yt);!o&&n===0?this.element.classList.add(Yt):o&&n!==0&&this.element.classList.remove(Yt)}this.label_.style.transform=r}this.rotation_=n}},Dr=Ln;var Mn=class extends Ot{constructor(t){t=t||{},super({element:document.createElement("div"),target:t.target});let e=t.className!==void 0?t.className:"ol-zoom",n=t.delta!==void 0?t.delta:1,r=t.zoomInClassName!==void 0?t.zoomInClassName:e+"-in",o=t.zoomOutClassName!==void 0?t.zoomOutClassName:e+"-out",s=t.zoomInLabel!==void 0?t.zoomInLabel:"+",a=t.zoomOutLabel!==void 0?t.zoomOutLabel:"\u2013",l=t.zoomInTipLabel!==void 0?t.zoomInTipLabel:"Zoom in",h=t.zoomOutTipLabel!==void 0?t.zoomOutTipLabel:"Zoom out",u=document.createElement("button");u.className=r,u.setAttribute("type","button"),u.title=l,u.appendChild(typeof s=="string"?document.createTextNode(s):s),u.addEventListener(_.CLICK,this.handleClick_.bind(this,n),!1);let c=document.createElement("button");c.className=o,c.setAttribute("type","button"),c.title=h,c.appendChild(typeof a=="string"?document.createTextNode(a):a),c.addEventListener(_.CLICK,this.handleClick_.bind(this,-n),!1);let d=e+" "+st+" "+St,f=this.element;f.className=d,f.appendChild(u),f.appendChild(c),this.duration_=t.duration!==void 0?t.duration:250}handleClick_(t,e){e.preventDefault(),this.zoomByDelta_(t)}zoomByDelta_(t){let n=this.getMap().getView();if(!n)return;let r=n.getZoom();if(r!==void 0){let o=n.getConstrainedZoom(r+t);this.duration_>0?(n.getAnimating()&&n.cancelAnimations(),n.animate({zoom:o,duration:this.duration_,easing:K})):n.setZoom(o)}}},Fr=Mn;function kr(i){i=i||{};let t=new D;return(i.zoom!==void 0?i.zoom:!0)&&t.push(new Fr(i.zoomOptions)),(i.rotate!==void 0?i.rotate:!0)&&t.push(new Dr(i.rotateOptions)),(i.attribution!==void 0?i.attribution:!0)&&t.push(new Nr(i.attributionOptions)),t}var Sn={ACTIVE:"active"};var Pn=class extends M{constructor(t){super(),this.on,this.once,this.un,t&&t.handleEvent&&(this.handleEvent=t.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(Sn.ACTIVE)}getMap(){return this.map_}handleEvent(t){return!0}setActive(t){this.set(Sn.ACTIVE,t)}setMap(t){this.map_=t}};function Kr(i,t,e){let n=i.getCenterInternal();if(n){let r=[n[0]+t[0],n[1]+t[1]];i.animateInternal({duration:e!==void 0?e:250,easing:qi,center:i.getConstrainedCenter(r)})}}function Nt(i,t,e,n){let r=i.getZoom();if(r===void 0)return;let o=i.getConstrainedZoom(r+t),s=i.getResolutionForZoom(o);i.getAnimating()&&i.cancelAnimations(),i.animate({resolution:s,anchor:e,duration:n!==void 0?n:250,easing:K})}var j=Pn;var bn=class extends j{constructor(t){super(),t=t||{},this.delta_=t.delta?t.delta:1,this.duration_=t.duration!==void 0?t.duration:250}handleEvent(t){let e=!1;if(t.type==R.DBLCLICK){let n=t.originalEvent,r=t.map,o=t.coordinate,s=n.shiftKey?-this.delta_:this.delta_,a=r.getView();Nt(a,s,o,this.duration_),n.preventDefault(),e=!0}return!e}},zr=bn;var On=class extends j{constructor(t){t=t||{},super(t),t.handleDownEvent&&(this.handleDownEvent=t.handleDownEvent),t.handleDragEvent&&(this.handleDragEvent=t.handleDragEvent),t.handleMoveEvent&&(this.handleMoveEvent=t.handleMoveEvent),t.handleUpEvent&&(this.handleUpEvent=t.handleUpEvent),t.stopDown&&(this.stopDown=t.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(t){return!1}handleDragEvent(t){}handleEvent(t){if(!t.originalEvent)return!0;let e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==R.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==R.POINTERUP){let n=this.handleUpEvent(t);this.handlingDownUpSequence=n&&this.targetPointers.length>0}}else if(t.type==R.POINTERDOWN){let n=this.handleDownEvent(t);this.handlingDownUpSequence=n,e=this.stopDown(n)}else t.type==R.POINTERMOVE&&this.handleMoveEvent(t);return!e}handleMoveEvent(t){}handleUpEvent(t){return!1}stopDown(t){return t}updateTrackedPointers_(t){t.activePointers&&(this.targetPointers=t.activePointers)}};function Dt(i){let t=i.length,e=0,n=0;for(let r=0;r<t;r++)e+=i[r].clientX,n+=i[r].clientY;return{clientX:e/t,clientY:n/t}}var Y=On;function Jt(i){let t=arguments;return function(e){let n=!0;for(let r=0,o=t.length;r<o&&(n=n&&t[r](e),!!n);++r);return n}}var Gr=function(i){let t=i.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},Qo=function(i){let t=i.map.getTargetElement(),e=i.map.getOwnerDocument().activeElement;return t.contains(e)},_e=function(i){return i.map.getTargetElement().hasAttribute("tabindex")?Qo(i):!0},Vr=ht;var ye=function(i){let t=i.originalEvent;return t.button==0&&!(ri&&Me&&t.ctrlKey)};var Ee=function(i){let t=i.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey};var Ur=function(i){let t=i.originalEvent;return Me?t.metaKey:t.ctrlKey},Zr=function(i){let t=i.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},xe=function(i){let t=i.originalEvent,e=t.target.tagName;return e!=="INPUT"&&e!=="SELECT"&&e!=="TEXTAREA"&&!t.target.isContentEditable},ve=function(i){let t=i.originalEvent;return I(t!==void 0,"mapBrowserEvent must originate from a pointer event"),t.pointerType=="mouse"};var Xr=function(i){let t=i.originalEvent;return I(t!==void 0,"mapBrowserEvent must originate from a pointer event"),t.isPrimary&&t.button===0};var Nn=class extends Y{constructor(t){super({stopDown:$}),t=t||{},this.kinetic_=t.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;let e=t.condition?t.condition:Jt(Ee,Xr);this.condition_=t.onFocusOnly?Jt(_e,e):e,this.noKinetic_=!1}handleDragEvent(t){let e=t.map;this.panning_||(this.panning_=!0,e.getView().beginInteraction());let n=this.targetPointers,r=e.getEventPixel(Dt(n));if(n.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(r[0],r[1]),this.lastCentroid){let o=[this.lastCentroid[0]-r[0],r[1]-this.lastCentroid[1]],a=t.map.getView();bi(o,a.getResolution()),It(o,a.getRotation()),a.adjustCenterInternal(o)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=r,this.lastPointersCount_=n.length,t.originalEvent.preventDefault()}handleUpEvent(t){let e=t.map,n=e.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){let r=this.kinetic_.getDistance(),o=this.kinetic_.getAngle(),s=n.getCenterInternal(),a=e.getPixelFromCoordinateInternal(s),l=e.getCoordinateFromPixelInternal([a[0]-r*Math.cos(o),a[1]-r*Math.sin(o)]);n.animateInternal({center:n.getConstrainedCenter(l),duration:500,easing:K})}return this.panning_&&(this.panning_=!1,n.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(t){if(this.targetPointers.length>0&&this.condition_(t)){let n=t.map.getView();return this.lastCentroid=null,n.getAnimating()&&n.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}},Hr=Nn;var Dn=class extends Y{constructor(t){t=t||{},super({stopDown:$}),this.condition_=t.condition?t.condition:Gr,this.lastAngle_=void 0,this.duration_=t.duration!==void 0?t.duration:250}handleDragEvent(t){if(!ve(t))return;let e=t.map,n=e.getView();if(n.getConstraints().rotation===At)return;let r=e.getSize(),o=t.pixel,s=Math.atan2(r[1]/2-o[1],o[0]-r[0]/2);if(this.lastAngle_!==void 0){let a=s-this.lastAngle_;n.adjustRotationInternal(-a)}this.lastAngle_=s}handleUpEvent(t){return ve(t)?(t.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(t){return ve(t)&&ye(t)&&this.condition_(t)?(t.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}},Wr=Dn;var Fn=class extends yt{constructor(t){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+t,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){let t=this.startPixel_,e=this.endPixel_,n="px",r=this.element_.style;r.left=Math.min(t[0],e[0])+n,r.top=Math.min(t[1],e[1])+n,r.width=Math.abs(e[0]-t[0])+n,r.height=Math.abs(e[1]-t[1])+n}setMap(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);let e=this.element_.style;e.left="inherit",e.top="inherit",e.width="inherit",e.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){let t=this.startPixel_,e=this.endPixel_,r=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);r[4]=r[0].slice(),this.geometry_?this.geometry_.setCoordinates([r]):this.geometry_=new xr([r])}getGeometry(){return this.geometry_}},jr=Fn;var Ce={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"},te=class extends O{constructor(t,e,n){super(t),this.coordinate=e,this.mapBrowserEvent=n}},kn=class extends Y{constructor(t){super(),this.on,this.once,this.un,t=t||{},this.box_=new jr(t.className||"ol-dragbox"),this.minArea_=t.minArea!==void 0?t.minArea:64,t.onBoxEnd&&(this.onBoxEnd=t.onBoxEnd),this.startPixel_=null,this.condition_=t.condition?t.condition:ye,this.boxEndCondition_=t.boxEndCondition?t.boxEndCondition:this.defaultBoxEndCondition}defaultBoxEndCondition(t,e,n){let r=n[0]-e[0],o=n[1]-e[1];return r*r+o*o>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(t){this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new te(Ce.BOXDRAG,t.coordinate,t))}handleUpEvent(t){this.box_.setMap(null);let e=this.boxEndCondition_(t,this.startPixel_,t.pixel);return e&&this.onBoxEnd(t),this.dispatchEvent(new te(e?Ce.BOXEND:Ce.BOXCANCEL,t.coordinate,t)),!1}handleDownEvent(t){return this.condition_(t)?(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new te(Ce.BOXSTART,t.coordinate,t)),!0):!1}onBoxEnd(t){}},Yr=kn;var Kn=class extends Yr{constructor(t){t=t||{};let e=t.condition?t.condition:Zr;super({condition:e,className:t.className||"ol-dragzoom",minArea:t.minArea}),this.duration_=t.duration!==void 0?t.duration:200,this.out_=t.out!==void 0?t.out:!1}onBoxEnd(t){let n=this.getMap().getView(),r=this.getGeometry();if(this.out_){let o=n.rotatedExtentForGeometry(r),s=n.getResolutionForExtentInternal(o),a=n.getResolution()/s;r=r.clone(),r.scale(a*a)}n.fitInternal(r,{duration:this.duration_,easing:K})}},qr=Kn;var lt={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};var zn=class extends j{constructor(t){super(),t=t||{},this.defaultCondition_=function(e){return Ee(e)&&xe(e)},this.condition_=t.condition!==void 0?t.condition:this.defaultCondition_,this.duration_=t.duration!==void 0?t.duration:100,this.pixelDelta_=t.pixelDelta!==void 0?t.pixelDelta:128}handleEvent(t){let e=!1;if(t.type==_.KEYDOWN){let n=t.originalEvent,r=n.key;if(this.condition_(t)&&(r==lt.DOWN||r==lt.LEFT||r==lt.RIGHT||r==lt.UP)){let s=t.map.getView(),a=s.getResolution()*this.pixelDelta_,l=0,h=0;r==lt.DOWN?h=-a:r==lt.LEFT?l=-a:r==lt.RIGHT?l=a:h=a;let u=[l,h];It(u,s.getRotation()),Kr(s,u,this.duration_),n.preventDefault(),e=!0}}return!e}},Br=zn;var Gn=class extends j{constructor(t){super(),t=t||{},this.condition_=t.condition?t.condition:function(e){return!Ur(e)&&xe(e)},this.delta_=t.delta?t.delta:1,this.duration_=t.duration!==void 0?t.duration:100}handleEvent(t){let e=!1;if(t.type==_.KEYDOWN||t.type==_.KEYPRESS){let n=t.originalEvent,r=n.key;if(this.condition_(t)&&(r==="+"||r==="-")){let o=t.map,s=r==="+"?this.delta_:-this.delta_,a=o.getView();Nt(a,s,void 0,this.duration_),n.preventDefault(),e=!0}}return!e}},$r=Gn;var Vn=class{constructor(t,e,n){this.decay_=t,this.minVelocity_=e,this.delay_=n,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(t,e){this.points_.push(t,e,Date.now())}end(){if(this.points_.length<6)return!1;let t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;let n=e-3;for(;n>0&&this.points_[n+2]>t;)n-=3;let r=this.points_[e+2]-this.points_[n+2];if(r<1e3/60)return!1;let o=this.points_[e]-this.points_[n],s=this.points_[e+1]-this.points_[n+1];return this.angle_=Math.atan2(s,o),this.initialVelocity_=Math.sqrt(o*o+s*s)/r,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}},Qr=Vn;var Un=class extends j{constructor(t){t=t||{},super(t),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=t.maxDelta!==void 0?t.maxDelta:1,this.duration_=t.duration!==void 0?t.duration:250,this.timeout_=t.timeout!==void 0?t.timeout:80,this.useAnchor_=t.useAnchor!==void 0?t.useAnchor:!0,this.constrainResolution_=t.constrainResolution!==void 0?t.constrainResolution:!1;let e=t.condition?t.condition:Vr;this.condition_=t.onFocusOnly?Jt(_e,e):e,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;let t=this.getMap();if(!t)return;t.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_)}handleEvent(t){if(!this.condition_(t)||t.type!==_.WHEEL)return!0;let n=t.map,r=t.originalEvent;r.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.coordinate);let o;if(t.type==_.WHEEL&&(o=r.deltaY,ii&&r.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(o/=re),r.deltaMode===WheelEvent.DOM_DELTA_LINE&&(o*=40)),o===0)return!1;this.lastDelta_=o;let s=Date.now();this.startTime_===void 0&&(this.startTime_=s),(!this.mode_||s-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(o)<4?"trackpad":"wheel");let a=n.getView();if(this.mode_==="trackpad"&&!(a.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(a.getAnimating()&&a.cancelAnimations(),a.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),a.adjustZoom(-o/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=s,!1;this.totalDelta_+=o;let l=Math.max(this.timeout_-(s-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,n),l),!1}handleWheelZoom_(t){let e=t.getView();e.getAnimating()&&e.cancelAnimations();let n=-S(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(e.getConstrainResolution()||this.constrainResolution_)&&(n=n?n>0?1:-1:0),Nt(e,n,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(t){this.useAnchor_=t,t||(this.lastAnchor_=null)}},Jr=Un;var Zn=class extends Y{constructor(t){t=t||{};let e=t;e.stopDown||(e.stopDown=$),super(e),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=t.threshold!==void 0?t.threshold:.3,this.duration_=t.duration!==void 0?t.duration:250}handleDragEvent(t){let e=0,n=this.targetPointers[0],r=this.targetPointers[1],o=Math.atan2(r.clientY-n.clientY,r.clientX-n.clientX);if(this.lastAngle_!==void 0){let l=o-this.lastAngle_;this.rotationDelta_+=l,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=l}this.lastAngle_=o;let s=t.map,a=s.getView();a.getConstraints().rotation!==At&&(this.anchor_=s.getCoordinateFromPixelInternal(s.getEventPixel(Dt(this.targetPointers))),this.rotating_&&(s.render(),a.adjustRotationInternal(e,this.anchor_)))}handleUpEvent(t){return this.targetPointers.length<2?(t.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(t){if(this.targetPointers.length>=2){let e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}},to=Zn;var Xn=class extends Y{constructor(t){t=t||{};let e=t;e.stopDown||(e.stopDown=$),super(e),this.anchor_=null,this.duration_=t.duration!==void 0?t.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(t){let e=1,n=this.targetPointers[0],r=this.targetPointers[1],o=n.clientX-r.clientX,s=n.clientY-r.clientY,a=Math.sqrt(o*o+s*s);this.lastDistance_!==void 0&&(e=this.lastDistance_/a),this.lastDistance_=a;let l=t.map,h=l.getView();e!=1&&(this.lastScaleDelta_=e),this.anchor_=l.getCoordinateFromPixelInternal(l.getEventPixel(Dt(this.targetPointers))),l.render(),h.adjustResolutionInternal(e,this.anchor_)}handleUpEvent(t){if(this.targetPointers.length<2){let n=t.map.getView(),r=this.lastScaleDelta_>1?1:-1;return n.endInteraction(this.duration_,r),!1}return!0}handleDownEvent(t){if(this.targetPointers.length>=2){let e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}},eo=Xn;function no(i){i=i||{};let t=new D,e=new Qr(-.005,.05,100);return(i.altShiftDragRotate!==void 0?i.altShiftDragRotate:!0)&&t.push(new Wr),(i.doubleClickZoom!==void 0?i.doubleClickZoom:!0)&&t.push(new zr({delta:i.zoomDelta,duration:i.zoomDuration})),(i.dragPan!==void 0?i.dragPan:!0)&&t.push(new Hr({onFocusOnly:i.onFocusOnly,kinetic:e})),(i.pinchRotate!==void 0?i.pinchRotate:!0)&&t.push(new to),(i.pinchZoom!==void 0?i.pinchZoom:!0)&&t.push(new eo({duration:i.zoomDuration})),(i.keyboard!==void 0?i.keyboard:!0)&&(t.push(new Br),t.push(new $r({delta:i.zoomDelta,duration:i.zoomDuration}))),(i.mouseWheelZoom!==void 0?i.mouseWheelZoom:!0)&&t.push(new Jr({onFocusOnly:i.onFocusOnly,duration:i.zoomDuration})),(i.shiftDragZoom!==void 0?i.shiftDragZoom:!0)&&t.push(new qr({duration:i.zoomDuration})),t}function Hn(i){return i[0]>0&&i[1]>0}function io(i){if(i instanceof dn){i.setMapInternal(null);return}i instanceof Bt&&i.getLayers().forEach(io)}function ro(i,t){if(i instanceof dn){i.setMapInternal(t);return}if(i instanceof Bt){let e=i.getLayers().getArray();for(let n=0,r=e.length;n<r;++n)ro(e[n],t)}}var Wn=class extends M{constructor(t){super(),t=t||{},this.on,this.once,this.un;let e=Jo(t);this.renderComplete_,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=t.maxTilesLoading!==void 0?t.maxTilesLoading:16,this.pixelRatio_=t.pixelRatio!==void 0?t.pixelRatio:re,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=kt(),this.pixelToCoordinateTransform_=kt(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=null,this.moveTolerance_=t.moveTolerance,this.keyboardEventTarget_=e.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,this.resizeObserver_=new ResizeObserver(()=>this.updateSize()),this.controls=e.controls||kr(),this.interactions=e.interactions||no({onFocusOnly:!0}),this.overlays_=e.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new br(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(L.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(L.VIEW,this.handleViewChanged_),this.addChangeListener(L.SIZE,this.handleSizeChanged_),this.addChangeListener(L.TARGET,this.handleTargetChanged_),this.setProperties(e.values);let n=this;t.view&&!(t.view instanceof V)&&t.view.then(function(r){n.setView(new V(r))}),this.controls.addEventListener(b.ADD,r=>{r.element.setMap(this)}),this.controls.addEventListener(b.REMOVE,r=>{r.element.setMap(null)}),this.interactions.addEventListener(b.ADD,r=>{r.element.setMap(this)}),this.interactions.addEventListener(b.REMOVE,r=>{r.element.setMap(null)}),this.overlays_.addEventListener(b.ADD,r=>{this.addOverlayInternal_(r.element)}),this.overlays_.addEventListener(b.REMOVE,r=>{let o=r.element.getId();o!==void 0&&delete this.overlayIdIndex_[o.toString()],r.element.setMap(null)}),this.controls.forEach(r=>{r.setMap(this)}),this.interactions.forEach(r=>{r.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(t){this.getControls().push(t)}addInteraction(t){this.getInteractions().push(t)}addLayer(t){this.getLayerGroup().getLayers().push(t)}handleLayerAdd_(t){ro(t.layer,this)}addOverlay(t){this.getOverlays().push(t)}addOverlayInternal_(t){let e=t.getId();e!==void 0&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(t,e,n){if(!this.frameState_||!this.renderer_)return;let r=this.getCoordinateFromPixelInternal(t);n=n!==void 0?n:{};let o=n.hitTolerance!==void 0?n.hitTolerance:0,s=n.layerFilter!==void 0?n.layerFilter:ht,a=n.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(r,this.frameState_,o,a,e,null,s,null)}getFeaturesAtPixel(t,e){let n=[];return this.forEachFeatureAtPixel(t,function(r){n.push(r)},e),n}getAllLayers(){let t=[];function e(n){n.forEach(function(r){r instanceof Bt?e(r.getLayers()):t.push(r)})}return e(this.getLayers()),t}hasFeatureAtPixel(t,e){if(!this.frameState_||!this.renderer_)return!1;let n=this.getCoordinateFromPixelInternal(t);e=e!==void 0?e:{};let r=e.layerFilter!==void 0?e.layerFilter:ht,o=e.hitTolerance!==void 0?e.hitTolerance:0,s=e.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(n,this.frameState_,o,s,r,null)}getEventCoordinate(t){return this.getCoordinateFromPixel(this.getEventPixel(t))}getEventCoordinateInternal(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))}getEventPixel(t){let n=this.viewport_.getBoundingClientRect(),r=this.getSize(),o=n.width/r[0],s=n.height/r[1],a="changedTouches"in t?t.changedTouches[0]:t;return[(a.clientX-n.left)/o,(a.clientY-n.top)/s]}getTarget(){return this.get(L.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(t){return Ht(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())}getCoordinateFromPixelInternal(t){let e=this.frameState_;return e?Se(e.pixelToCoordinateTransform,t.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(t){let e=this.overlayIdIndex_[t.toString()];return e!==void 0?e:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(L.LAYERGROUP)}setLayers(t){let e=this.getLayerGroup();if(t instanceof D){e.setLayers(t);return}let n=e.getLayers();n.clear(),n.extend(t)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){let t=this.getLayerGroup().getLayerStatesArray();for(let e=0,n=t.length;e<n;++e){let r=t[e];if(!r.visible)continue;let o=r.layer.getRenderer();if(o&&!o.ready)return!0;let s=r.layer.getSource();if(s&&s.loading)return!0}return!1}getPixelFromCoordinate(t){let e=G(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(e)}getPixelFromCoordinateInternal(t){let e=this.frameState_;return e?Se(e.coordinateToPixelTransform,t.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(L.SIZE)}getView(){return this.get(L.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){let t=this.getTargetElement();return t?t.ownerDocument:document}getTilePriority(t,e,n,r){return Or(this.frameState_,t,e,n,r)}handleBrowserEvent(t,e){e=e||t.type;let n=new H(e,this,t);this.handleMapBrowserEvent(n)}handleMapBrowserEvent(t){if(!this.frameState_)return;let e=t.originalEvent,n=e.type;if(n===$t.POINTERDOWN||n===_.WHEEL||n===_.KEYDOWN){let r=this.getOwnerDocument(),o=this.viewport_.getRootNode?this.viewport_.getRootNode():r,s=e.target;if(this.overlayContainerStopEvent_.contains(s)||!(o===r?r.documentElement:o).contains(s))return}if(t.frameState=this.frameState_,this.dispatchEvent(t)!==!1){let r=this.getInteractions().getArray().slice();for(let o=r.length-1;o>=0;o--){let s=r[o];if(s.getMap()!==this||!s.getActive()||!this.getTargetElement())continue;if(!s.handleEvent(t)||t.propagationStopped)break}}}handlePostRender(){let t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){let r=this.maxTilesLoading_,o=r;if(t){let s=t.viewHints;if(s[N.ANIMATING]||s[N.INTERACTING]){let a=Date.now()-t.time>8;r=a?0:8,o=a?0:2}}e.getTilesLoading()<r&&(e.reprioritize(),e.loadMoreTiles(r,o))}t&&this.renderer_&&!t.animate&&(this.renderComplete_===!0?(this.hasListener(J.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(J.RENDERCOMPLETE,t),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new at(W.LOADEND,this,t)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new at(W.LOADSTART,this,t))));let n=this.postRenderFunctions_;for(let r=0,o=n.length;r<o;++r)n[r](this,t);n.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let n=0,r=this.targetChangeHandlerKeys_.length;n<r;++n)w(this.targetChangeHandlerKeys_[n]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(_.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(_.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,qt(this.viewport_)}if(this.targetElement_){this.resizeObserver_.unobserve(this.targetElement_);let n=this.targetElement_.getRootNode();n instanceof ShadowRoot&&this.resizeObserver_.unobserve(n.host),this.setSize(void 0)}let t=this.getTarget(),e=typeof t=="string"?document.getElementById(t):t;if(this.targetElement_=e,!e)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{e.appendChild(this.viewport_),this.renderer_||(this.renderer_=new Mr(this)),this.mapBrowserEventHandler_=new Sr(this,this.moveTolerance_);for(let o in R)this.mapBrowserEventHandler_.addEventListener(R[o],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(_.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(_.WHEEL,this.boundHandleBrowserEvent_,oe?{passive:!1}:!1);let n=this.keyboardEventTarget_?this.keyboardEventTarget_:e;this.targetChangeHandlerKeys_=[E(n,_.KEYDOWN,this.handleBrowserEvent,this),E(n,_.KEYPRESS,this.handleBrowserEvent,this)];let r=e.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.observe(r.host),this.resizeObserver_.observe(e)}this.updateSize()}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(w(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(w(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);let t=this.getView();t&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=E(t,B.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=E(t,_.CHANGE,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(w),this.layerGroupPropertyListenerKeys_=null);let t=this.getLayerGroup();t&&(this.handleLayerAdd_(new U("addlayer",t)),this.layerGroupPropertyListenerKeys_=[E(t,B.PROPERTYCHANGE,this.render,this),E(t,_.CHANGE,this.render,this),E(t,"addlayer",this.handleLayerAdd_,this),E(t,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){let t=this.getLayerGroup().getLayerStatesArray();for(let e=0,n=t.length;e<n;++e){let r=t[e].layer;r.hasRenderer()&&r.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}flushDeclutterItems(){let t=this.frameState_;t&&this.renderer_.flushDeclutterItems(t)}removeControl(t){return this.getControls().remove(t)}removeInteraction(t){return this.getInteractions().remove(t)}removeLayer(t){return this.getLayerGroup().getLayers().remove(t)}handleLayerRemove_(t){io(t.layer)}removeOverlay(t){return this.getOverlays().remove(t)}renderFrame_(t){let e=this.getSize(),n=this.getView(),r=this.frameState_,o=null;if(e!==void 0&&Hn(e)&&n&&n.isDef()){let s=n.getHints(this.frameState_?this.frameState_.viewHints:void 0),a=n.getState();if(o={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterTree:null,extent:zt(a.center,a.resolution,a.rotation,e),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:e,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:a,viewHints:s,wantedTiles:{},mapId:ct(this),renderTargets:{}},a.nextCenter&&a.nextResolution){let l=isNaN(a.nextRotation)?a.rotation:a.nextRotation;o.nextExtent=zt(a.nextCenter,a.nextResolution,l,e)}}this.frameState_=o,this.renderer_.renderFrame(o),o&&(o.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,o.postRenderFunctions),r&&(!this.previousExtent_||!mt(this.previousExtent_)&&!Pe(o.extent,this.previousExtent_))&&(this.dispatchEvent(new at(W.MOVESTART,this,r)),this.previousExtent_=dt(this.previousExtent_)),this.previousExtent_&&!o.viewHints[N.ANIMATING]&&!o.viewHints[N.INTERACTING]&&!Pe(o.extent,this.previousExtent_)&&(this.dispatchEvent(new at(W.MOVEEND,this,o)),li(o.extent,this.previousExtent_))),this.dispatchEvent(new at(W.POSTRENDER,this,o)),this.renderComplete_=this.hasListener(W.LOADSTART)||this.hasListener(W.LOADEND)||this.hasListener(J.RENDERCOMPLETE)?!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady():void 0,this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(t){let e=this.getLayerGroup();e&&this.handleLayerRemove_(new U("removelayer",e)),this.set(L.LAYERGROUP,t)}setSize(t){this.set(L.SIZE,t)}setTarget(t){this.set(L.TARGET,t)}setView(t){if(!t||t instanceof V){this.set(L.VIEW,t);return}this.set(L.VIEW,new V);let e=this;t.then(function(n){e.setView(new V(n))})}updateSize(){let t=this.getTargetElement(),e;if(t){let r=getComputedStyle(t),o=t.offsetWidth-parseFloat(r.borderLeftWidth)-parseFloat(r.paddingLeft)-parseFloat(r.paddingRight)-parseFloat(r.borderRightWidth),s=t.offsetHeight-parseFloat(r.borderTopWidth)-parseFloat(r.paddingTop)-parseFloat(r.paddingBottom)-parseFloat(r.borderBottomWidth);!isNaN(o)&&!isNaN(s)&&(e=[o,s],!Hn(e)&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)&&de("No map visible because the map container's width or height are 0."))}let n=this.getSize();e&&(!n||!Et(e,n))&&(this.setSize(e),this.updateViewportSize_(e))}updateViewportSize_(t){let e=this.getView();e&&e.setViewportSize(t)}};function Jo(i){let t=null;i.keyboardEventTarget!==void 0&&(t=typeof i.keyboardEventTarget=="string"?document.getElementById(i.keyboardEventTarget):i.keyboardEventTarget);let e={},n=i.layers&&typeof i.layers.getLayers=="function"?i.layers:new Bt({layers:i.layers});e[L.LAYERGROUP]=n,e[L.TARGET]=i.target,e[L.VIEW]=i.view instanceof V?i.view:new V;let r;i.controls!==void 0&&(Array.isArray(i.controls)?r=new D(i.controls.slice()):(I(typeof i.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),r=i.controls));let o;i.interactions!==void 0&&(Array.isArray(i.interactions)?o=new D(i.interactions.slice()):(I(typeof i.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),o=i.interactions));let s;return i.overlays!==void 0?Array.isArray(i.overlays)?s=new D(i.overlays.slice()):(I(typeof i.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),s=i.overlays):s=new D,{controls:r,interactions:o,keyboardEventTarget:t,overlays:s,values:e}}var oo=Wn;window.traineratwot={};try{let t=function(e,n=0,r=0,o=10,s="en-US"){let a="EPSG:4326",l=new MousePosition({coordinateFormat:createStringXY(4),projection:a,className:`mouse-position-${e}`,target:document.getElementById(`OSMap-${e}`)}),h=new Feature({projection:a,geometry:new Point(fromLonLat([n,r],a))}),u=new VectorSource({features:[h]}),c=new VectorLayer({source:u}),d=new TileLayer({source:new OSM}),f=document.getElementById(`OSMap-${e}`),m=new View({projection:a,center:fromLonLat([n,r],a),zoom:o}),g=new oo({controls:defaultControls().extend([l]),layers:[d,c],target:f,view:m}),p=new Geocoder("nominatim",{provider:"osm",lang:s,placeholder:"\u041F\u043E\u0438\u0441\u043A...",limit:5,keepOpen:!0});g.addControl(p);try{p.on("addresschosen",function(y){console.log(y);let q=y.feature,C=y.coordinate;q.setStyle(new Style({image:new Icon({color:"rgba(0, 0, 0, 0)",crossOrigin:"anonymous",src:"https://openlayers.org/en/latest/examples/data/dot.png",scale:.01})})),m.setCenter(fromLonLat([C[0],C[1]],a))})}catch(y){console.error(y)}function v(){let[y,q]=g.getView().getCenter();h.getGeometry().setCoordinates([y,q])}try{g.on("movestart",v),g.on("moveend",v)}catch(y){console.error(y)}return f.classList.add("map-done"),new i(m,a)};class i{constructor(n,r){this.view=n;this.projection=r}onChange(n){try{this.view.on("change",()=>{let[r,o]=this.getCoordinates();n(r,o)})}catch(r){console.error(r)}}getCoordinates(){return this.view.getCenter()}setCoordinates(n,r){this.view.setCenter(fromLonLat([n,r],this.projection))}}window.traineratwot.GetPointMap=t}catch{}
